<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algo-Rythmn.ai | Pharmacy Compliance Intelligence</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            /* GEN AI PALETTE */
            --primary: #00695C;
            --primary-light: #E0F2F1;
            --primary-dark: #004D40;
            
            --accent-green: #10B981;
            --accent-red: #EF4444;
            --accent-orange: #F59E0B;
            
            --bg-body: #FAFAFA;
            --bg-surface: #FFFFFF;
            --bg-subtle: #F3F4F6;
            
            --text-main: #111827;
            --text-muted: #6B7280;
            
            --border-subtle: #E5E7EB;
            
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-pill: 100px;
            
            --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            --shadow-float: 0 20px 25px -5px rgba(0, 0, 0, 0.05);
            
            --transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            height: 100vh;
            display: flex;
            overflow: hidden;
            font-size: 15px;
        }

        /* === LEFT ICON RAIL === */
        .sidebar {
            width: 80px;
            background: var(--bg-surface);
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px 0;
            z-index: 50;
            flex-shrink: 0;
        }

        .brand-icon {
            width: 40px; height: 40px;
            color: var(--primary); font-size: 1.5rem;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 40px;
        }

        .nav-item {
            width: 48px; height: 48px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            color: #9CA3AF; margin-bottom: 12px;
            cursor: pointer; transition: var(--transition);
            position: relative;
        }
        .nav-item:hover, .nav-item.active {
            background: var(--primary-light); color: var(--primary);
        }
        /* Tooltip */
        .nav-item::after {
            content: attr(data-tooltip);
            position: absolute; left: 60px;
            background: #1F2937; color: white;
            padding: 6px 12px; border-radius: 6px;
            font-size: 0.75rem; font-weight: 600;
            opacity: 0; pointer-events: none; transition: 0.2s;
            white-space: nowrap; z-index: 100;
        }
        .nav-item:hover::after { opacity: 1; }

        /* === MAIN CONTENT === */
        .main-content {
            flex: 1; position: relative; overflow: hidden;
            display: flex; flex-direction: column;
        }

        .top-bar {
            position: absolute; top: 24px; right: 32px; z-index: 10;
            display: flex; align-items: center; gap: 16px;
        }
        .user-pill {
            display: flex; align-items: center; gap: 8px;
            background: var(--bg-surface); padding: 6px 12px;
            border-radius: var(--radius-pill); border: 1px solid var(--border-subtle);
            font-size: 0.85rem; font-weight: 500; cursor: pointer;
        }

        /* VIEWS */
        .view-section {
            width: 100%; height: 100%; overflow-y: auto;
            display: none; opacity: 0; transition: opacity 0.3s;
        }
        .view-section.active { display: block; opacity: 1; }

        /* === HOME VIEW (GEN AI STYLE) === */
        #view-home {
            background: linear-gradient(135deg, #FAFAFA 0%, #E0F2F1 50%, #FAFAFA 100%);
            position: relative;
            overflow: hidden;
        }
        
        #view-home::before {
            content: '';
            position: absolute;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(0, 105, 92, 0.08) 0%, transparent 70%);
            border-radius: 50%;
            top: -200px;
            right: -100px;
            pointer-events: none;
        }
        
        #view-home::after {
            content: '';
            position: absolute;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(0, 105, 92, 0.05) 0%, transparent 70%);
            border-radius: 50%;
            bottom: -150px;
            left: -100px;
            pointer-events: none;
        }
        
        .gen-ai-container {
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; min-height: 100%;
            padding: 60px 40px; max-width: 1200px; margin: 0 auto; width: 100%;
            position: relative; z-index: 1;
        }

        .hero-title {
            font-size: 2.5rem; font-weight: 700; color: var(--text-main);
            margin-bottom: 8px; text-align: center; letter-spacing: -1px;
        }
        .hero-subtitle { color: var(--text-muted); margin-bottom: 40px; text-align: center; }

        .prompt-bar-container {
            width: 720px; max-width: 100%; position: relative; 
            margin-bottom: 40px;
            align-self: center;
        }
        .prompt-input {
            width: 100%; padding: 20px 60px 20px 24px;
            border-radius: var(--radius-xl); border: 1px solid var(--border-subtle);
            background: var(--bg-surface); font-size: 1.1rem;
            box-shadow: var(--shadow-card); transition: var(--transition);
        }
        .prompt-input:focus {
            box-shadow: var(--shadow-float); border-color: var(--primary);
        }
        .prompt-submit {
            position: absolute; right: 12px; top: 50%; transform: translateY(-50%);
            width: 40px; height: 40px; background: var(--primary); color: white;
            border-radius: 50%; border: none; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }

        /* Action Chips */
        .action-chips {
            display: flex; gap: 12px; margin-bottom: 48px; flex-wrap: wrap; justify-content: center;
        }
        .chip {
            background: var(--bg-surface); border: 1px solid var(--border-subtle);
            padding: 10px 20px; border-radius: var(--radius-pill);
            font-size: 0.9rem; font-weight: 600; color: var(--text-main);
            cursor: pointer; display: flex; align-items: center; gap: 8px;
            transition: var(--transition);
        }
        .chip:hover { border-color: var(--primary); color: var(--primary); transform: translateY(-2px); }

        /* WIDGET GRID (Feed & Watchlist) */
        .widget-grid {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; width: 100%;
        }
        
        .widget-card {
            background: var(--bg-surface); padding: 24px;
            border-radius: var(--radius-lg); border: 1px solid var(--border-subtle);
            transition: var(--transition); display: flex; flex-direction: column;
            height: 100%;
            cursor: pointer; /* Indicates clickability */
            position: relative;
        }
        
        /* Interactive Hover State for Widgets */
        .widget-card:hover { 
            border-color: var(--primary); 
            box-shadow: var(--shadow-float); 
            transform: translateY(-4px);
        }
        .widget-card:hover .widget-title i {
            transform: scale(1.1);
        }
        
        /* Click hint */
        .widget-card::after {
            content: 'Click to view details';
            position: absolute;
            bottom: 12px;
            right: 12px;
            font-size: 0.7rem;
            color: var(--text-muted);
            opacity: 0;
            transition: opacity 0.2s;
        }
        .widget-card:hover::after {
            opacity: 1;
        }

        .widget-title {
            display: flex; align-items: center; gap: 10px; font-weight: 700;
            margin-bottom: 16px; font-size: 1rem;
        }
        .widget-title i { color: var(--primary); transition: 0.2s; }

        /* Feed Specifics */
        .feed-item {
            padding: 12px 0; border-bottom: 1px solid var(--border-subtle);
        }
        .feed-item:last-child { border-bottom: none; }
        .feed-tag {
            font-size: 0.65rem; font-weight: 700; text-transform: uppercase;
            padding: 2px 6px; border-radius: 4px; margin-bottom: 4px; display: inline-block;
        }
        .tag-law { background: #FEE2E2; color: #991B1B; }
        .tag-guideline { background: #DBEAFE; color: #1E40AF; }
        .tag-best-practice { background: #E0F2F1; color: #00695C; }

        /* === SEARCH / KNOWLEDGE BASE VIEW === */
        .search-results { max-width: 800px; margin: 0 auto; padding-top: 40px; }
        .result-card {
            background: var(--bg-surface); padding: 24px; border-radius: var(--radius-lg);
            margin-bottom: 24px; border: 1px solid var(--border-subtle);
        }
        .source-pill {
            background: #F3F4F6; padding: 4px 12px; border-radius: 20px;
            font-size: 0.75rem; color: #4B5563; font-weight: 600; margin-right: 8px;
        }

        /* === MODAL STYLES === */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(5px);
            z-index: 1000; display: none; align-items: center; justify-content: center;
        }
        .modal-overlay.open { display: flex; animation: fadeModal 0.2s ease-out; }
        @keyframes fadeModal { from { opacity: 0; } to { opacity: 1; } }

        .modal-box {
            background: white; width: 700px; max-width: 90%; max-height: 85vh; overflow-y: auto;
            border-radius: var(--radius-xl); box-shadow: var(--shadow-float);
            border: 1px solid var(--border-subtle); padding: 40px; position: relative;
            transform: translateY(0); animation: slideModal 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @keyframes slideModal { from { transform: translateY(20px); } to { transform: translateY(0); } }

        .modal-close {
            position: absolute; top: 24px; right: 24px; font-size: 1.2rem;
            cursor: pointer; color: #9CA3AF; transition: 0.2s;
        }
        .modal-close:hover { color: var(--text-main); }

        /* TONE SELECTOR */
        .tone-selector { display: flex; gap: 12px; margin-bottom: 24px; }
        .tone-option {
            flex: 1; padding: 12px; border: 2px solid var(--border-subtle);
            border-radius: 12px; text-align: center; cursor: pointer; transition: 0.2s;
        }
        .tone-option:hover { border-color: var(--primary); }
        .tone-option.selected {
            border-color: var(--primary); background: var(--primary-light); color: var(--primary);
        }

        /* WIZARD STEPS */
        .wizard-step { display: none; }
        .wizard-step.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; } }

        .btn-primary {
            background: var(--primary); color: white; padding: 12px 24px;
            border-radius: var(--radius-pill); border: none; cursor: pointer;
            font-weight: 600; font-size: 0.95rem;
        }
        
        /* Detail Lists for Modals */
        .detail-row {
            display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-subtle);
        }
        .detail-label { font-weight: 600; color: var(--text-muted); }
        .detail-value { font-weight: 600; color: var(--text-main); }
        
        .progress-container {
            width: 100%; background: #E5E7EB; height: 10px; border-radius: 5px; overflow: hidden; margin-top: 8px;
        }
        .progress-fill {
            height: 100%; background: var(--primary); border-radius: 5px;
        }

        /* === STUDIO VIEW (UPDATED) === */
        .studio-container { max-width: 100%; margin: 0; padding: 0; width: 100%; height: 100%; display: flex; }
        .studio-header { margin-bottom: 32px; }
        .studio-header h2 { font-size: 2rem; margin-bottom: 8px; }
        .studio-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }
        
        /* NotebookLM-style Layout */
        .studio-sidebar-left { width: 320px; background: var(--bg-surface); border-right: 1px solid var(--border-subtle); display: flex; flex-direction: column; height: 100%; }
        .studio-main { flex: 1; display: flex; flex-direction: column; height: 100%; background: var(--bg-body); }
        .studio-sidebar-right { width: 360px; background: var(--bg-surface); border-left: 1px solid var(--border-subtle); display: flex; flex-direction: column; height: 100%; overflow-y: auto; padding: 24px; }
        
        /* Left Sidebar - Resources */
        .resources-header { padding: 24px; border-bottom: 1px solid var(--border-subtle); }
        .resources-header h3 { font-size: 1.1rem; font-weight: 700; margin-bottom: 8px; }
        .resources-list { flex: 1; overflow-y: auto; padding: 16px; }
        .resource-item { background: var(--bg-subtle); padding: 12px 16px; border-radius: 8px; margin-bottom: 8px; cursor: pointer; transition: var(--transition); border: 1px solid transparent; }
        .resource-item:hover { border-color: var(--primary); background: var(--primary-light); }
        .resource-item i { color: var(--primary); margin-right: 8px; }
        .upload-zone { margin: 16px; padding: 32px; border: 2px dashed var(--border-subtle); border-radius: 12px; text-align: center; color: var(--text-muted); cursor: pointer; transition: var(--transition); }
        .upload-zone:hover { border-color: var(--primary); color: var(--primary); background: var(--primary-light); }
        
        .file-drop-zone { border: 2px dashed var(--border-subtle); border-radius: 12px; padding: 48px 24px; text-align: center; transition: var(--transition); cursor: pointer; background: var(--bg-subtle); }
        .file-drop-zone:hover { border-color: var(--primary); background: var(--primary-light); }
        .file-drop-zone.drag-over { border-color: var(--primary); background: var(--primary-light); border-style: solid; }
        
        .resource-tag { display: inline-block; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; }
        .tag-pdf { background: #FEE2E2; color: #991B1B; }
        .tag-video { background: #DBEAFE; color: #1E40AF; }
        .tag-audio { background: #F3E8FF; color: #6B21A8; }
        .tag-text { background: #E0F2F1; color: #00695C; }
        
        /* Middle - Chat */
        .studio-chat-container { flex: 1; display: flex; flex-direction: column; height: 100%; max-width: 900px; margin: 0 auto; width: 100%; padding: 40px 40px 0 40px; }
        .chat-messages { flex: 1; overflow-y: auto; padding: 20px 0; }
        .chat-message { margin-bottom: 24px; display: flex; flex-direction: column; }
        .chat-message.user { align-items: flex-end; }
        .chat-bubble { background: var(--bg-surface); padding: 16px 20px; border-radius: 16px; max-width: 70%; border: 1px solid var(--border-subtle); }
        .chat-message.user .chat-bubble { background: var(--primary); color: white; border-color: var(--primary); }
        .chat-input-wrapper { padding: 24px; border-top: 1px solid var(--border-subtle); background: var(--bg-surface); }
        
        /* Right Sidebar - Studio Tools */
        .studio-tools-header { font-size: 1.1rem; font-weight: 700; margin-bottom: 16px; }
        .studio-tool-item { background: var(--bg-subtle); padding: 16px; border-radius: 12px; margin-bottom: 12px; cursor: pointer; transition: var(--transition); border: 1px solid transparent; }
        .studio-tool-item:hover { border-color: var(--primary); transform: translateX(-4px); }
        
        .studio-card {
            background: var(--bg-surface); border-radius: var(--radius-lg); padding: 24px;
            cursor: pointer; transition: var(--transition); border: 1px solid var(--border-subtle);
            display: flex; flex-direction: column; height: 180px; position: relative; overflow: hidden;
        }
        .studio-card:hover { border-color: var(--primary); box-shadow: var(--shadow-card); transform: translateY(-2px); }
        .studio-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%;
            background: var(--primary); opacity: 0; transition: opacity 0.2s;
        }
        .studio-card:hover::before { opacity: 1; }

        .studio-icon {
            width: 40px; height: 40px; background: var(--bg-subtle); border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            color: var(--text-main); font-size: 1.1rem; margin-bottom: 16px;
        }
        .studio-card h3 { font-size: 1.1rem; margin-bottom: 8px; font-weight: 600; }
        .studio-card p { font-size: 0.85rem; color: var(--text-muted); line-height: 1.5; }
        
        /* Generation Animation Styles */
        .gen-loader { text-align: center; padding: 40px 0; }
        .gen-spinner { font-size: 3rem; color: var(--primary); margin-bottom: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .gen-steps { text-align: left; max-width: 300px; margin: 0 auto; color: var(--text-muted); font-size: 0.9rem; }
        .gen-step { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; opacity: 0.5; }
        .gen-step.active { opacity: 1; color: var(--text-main); font-weight: 600; }
        .gen-step.done { color: var(--accent-green); opacity: 1; }

        /* Result Preview Styles */
        .preview-box {
            background: var(--bg-subtle); border-radius: var(--radius-md); padding: 24px; margin-top: 24px;
        }
        
        /* Audio Player Mock */
        .audio-player { display: flex; align-items: center; gap: 16px; background: white; padding: 16px; border-radius: 50px; border: 1px solid var(--border-subtle); }
        .play-btn { width: 40px; height: 40px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; cursor: pointer; }
        .waveform { flex: 1; height: 24px; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><path d="M0 10 L5 2 L10 18 L15 5 L20 15 L25 8 L30 12 L35 4 L40 16 L45 6 L50 14 L55 3 L60 17 L65 9 L70 11 L75 1 L80 19 L85 7 L90 13 L95 5 L100 10" stroke="%2394A3B8" fill="none" stroke-width="2"/></svg>'); background-size: cover; opacity: 0.5; }

        /* Quiz Mock */
        .quiz-question { font-weight: 600; font-size: 1.1rem; margin-bottom: 16px; }
        .quiz-option { 
            padding: 12px 16px; border: 1px solid var(--border-subtle); border-radius: 8px; 
            margin-bottom: 8px; cursor: pointer; transition: 0.2s; background: white;
        }
        .quiz-option:hover { background: var(--primary-light); border-color: var(--primary); }
        .quiz-option.selected { background: var(--primary); color: white; border-color: var(--primary); }

        /* Slide Deck Mock */
        .slide-preview { aspect-ratio: 16/9; background: white; border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: var(--text-muted); margin-bottom: 16px; position: relative; }
        .slide-controls { display: flex; justify-content: center; gap: 16px; }

        /* === NEW DYNAMIC COMPONENTS === */
        
        /* Toast Notifications */
        .toast-container {
            position: fixed; bottom: 24px; right: 24px; z-index: 2000;
            display: flex; flex-direction: column; gap: 12px; pointer-events: none;
        }
        .toast {
            background: #1F2937; color: white; padding: 12px 24px;
            border-radius: 12px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
            display: flex; align-items: center; gap: 12px;
            animation: slideInRight 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            min-width: 300px; pointer-events: auto;
        }
        @keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* Inspector View Metrics */
        .inspector-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 32px; }
        .inspector-grid { display: grid; grid-template-columns: 300px 1fr; gap: 24px; height: calc(100vh - 200px); }
        .profile-panel { background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; }
        .analytics-panel { display: flex; flex-direction: column; gap: 24px; }
        .stat-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
        .uni-stat { background: white; padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border-subtle); }
        .chart-container { background: white; padding: 24px; border-radius: var(--radius-lg); border: 1px solid var(--border-subtle); flex: 1; display: flex; align-items: flex-end; justify-content: space-around; padding-bottom: 0; overflow: hidden; }
        
        /* Simple CSS Bar Chart */
        .bar-group { display: flex; flex-direction: column; align-items: center; gap: 8px; height: 100%; justify-content: flex-end; width: 40px; }
        .bar { width: 100%; background: var(--primary-light); border-radius: 8px 8px 0 0; transition: height 1s ease-out; position: relative; }
        .bar::after { content: attr(data-val); position: absolute; top: -25px; left: 50%; transform: translateX(-50%); font-size: 0.75rem; font-weight: 700; color: var(--text-muted); opacity:0; transition:0.2s;}
        .bar:hover { background: var(--primary); }
        .bar:hover::after { opacity: 1; top: -20px; }

        /* === INTERACTIVE DEMO STYLES === */
        /* Audio Visualization */
        .waveform-bar {
            flex: 1; background: #9CA3AF; border-radius: 2px; animation: none;
        }
        .audio-player.playing .waveform-bar {
            animation: bounce 0.5s infinite ease-in-out; background: var(--primary);
        }
        @keyframes bounce { 0%, 100% { height: 20%; } 50% { height: 80%; } }

        /* Quiz Feedback */
        .quiz-option.correct { background: #DCFCE7; border-color: #22C55E; color: #15803D; }
        .quiz-option.wrong { background: #FEE2E2; border-color: #EF4444; color: #991B1B; }
        
        /* Slides Transition */
        .slide-content { animation: fadeInSlide 0.3s; }
        @keyframes fadeInSlide { from { opacity: 0; transform: translateX(10px); } to { opacity: 1; transform: translateX(0); } }

        /* Settings Toggles */
        .toggle-switch {
            width: 44px; height: 24px; background: #E5E7EB; border-radius: 20px;
            position: relative; cursor: pointer; transition: 0.2s;
        }
        .toggle-switch.active { background: var(--primary); }
        .toggle-switch::after {
            content: ''; position: absolute; top: 2px; left: 2px; width: 20px; height: 20px;
            background: white; border-radius: 50%; transition: 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        .toggle-switch.active::after { left: 22px; }

    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="brand-icon">
            <i class="fas fa-staff-snake"></i>
        </div>
        
        <div class="nav-item active" onclick="switchView('home', this)" data-tooltip="Home">
            <i class="fas fa-home"></i>
        </div>
        <div class="nav-item" onclick="switchView('studio', this)" data-tooltip="Content Studio">
            <i class="fas fa-shapes"></i>
        </div>
        <div class="nav-item" onclick="switchView('search', this)" data-tooltip="Regulatory Search">
            <i class="fas fa-search"></i>
        </div>
        <div class="nav-item" onclick="switchView('inspector', this)" data-tooltip="Inspector Intel">
            <i class="fas fa-user-secret"></i>
        </div>
        <div class="nav-item" onclick="switchView('monitoring', this)" data-tooltip="AI Report Classifier">
            <i class="fas fa-chart-line"></i>
        </div>
        <div class="nav-item" onclick="switchView('usecases', this)" data-tooltip="Use Cases">
            <i class="fas fa-lightbulb"></i>
        </div>
        <div class="nav-item" onclick="switchView('settings', this)" style="margin-top: auto;" data-tooltip="Settings">
            <i class="fas fa-cog"></i>
        </div>
    </nav>

    <main class="main-content">
        
        <div class="top-bar">
            <div class="user-pill">
                <i class="fas fa-user-circle"></i> Dr. Peter
            </div>
        </div>

        <section id="view-home" class="view-section active">
            <div class="gen-ai-container">
                <h1 class="hero-title">Pharmacy Compliance <span style="color:#00695C">Intelligence</span></h1>
                <p class="hero-subtitle">Ask a question, upload a report, or generate a response.</p>

                <div class="prompt-bar-container">
                    <input type="text" class="prompt-input" id="homePromptInput" placeholder="How do I comply with the new Opioid guidelines?" onkeypress="handleHomePrompt(event)">
                    <button class="prompt-submit"><i class="fas fa-arrow-right"></i></button>
                </div>

                <div class="action-chips">
                    <div class="chip" onclick="openModal('responseModal')">
                        <i class="fas fa-pen-fancy"></i> Draft Response
                    </div>
                    <div class="chip" onclick="openModal('sopModal')">
                        <i class="fas fa-wand-magic-sparkles"></i> SOP Generator
                    </div>
                    <div class="chip" onclick="switchView('studio', document.querySelectorAll('.nav-item')[1])">
                        <i class="fas fa-shapes"></i> Content Studio
                    </div>
                </div>

                <div class="widget-grid">
                    
                    <div class="widget-card" onclick="switchView('search', document.querySelectorAll('.nav-item')[2])">
                        <div class="widget-title">
                            <i class="fas fa-bell"></i> Regulatory Updates
                        </div>
                        <div class="feed-item">
                            <span class="feed-tag tag-law">Critical - Effective in 23 days</span>
                            <div style="font-weight: 700; font-size: 0.9rem; color: var(--text-main);">Opioid Agonist Therapy Verification</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); line-height: 1.4;">Mandatory Netcare check before dispensing. Standard 18.2</div>
                        </div>
                        <div class="feed-item">
                            <span class="feed-tag tag-guideline">Effective July 1st</span>
                            <div style="font-weight: 700; font-size: 0.9rem; color: var(--text-main);">Sterile Compounding Standards</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); line-height: 1.4;">NAPRA Model Standards v4.1 - Enhanced monitoring required</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;margin-top:10px;">
                            <span style="color: var(--text-muted); font-size: 0.75rem;">5 updates • Last checked 2h ago</span>
                            <span style="color: var(--primary); font-weight: 700; font-size: 0.85rem;">View All →</span>
                        </div>

                    </div>

                    <div class="widget-card" onclick="switchView('inspector', document.querySelectorAll('.nav-item')[3])">
                        <div class="widget-title">
                            <i class="fas fa-user-secret"></i> Pre-Inspection Intelligence
                        </div>
                        <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 16px; font-weight: 500;">
                            Predict what your inspector will look for based on 45+ past audits
                        </div>
                        <div style="display: flex; gap: 12px; align-items: center; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle);">
                            <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary); font-weight: 700; font-size: 0.95rem; border: 2px solid white; box-shadow: 0 2px 8px rgba(0, 105, 92, 0.15);">JS</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 700; font-size: 0.9rem; color: var(--text-main);">Inspector J. Smith</div>
                                <div style="font-size: 0.75rem; color: var(--text-muted);">Next Audit: Feb 12 (6 days)</div>
                            </div>
                        </div>
                        <div style="background: linear-gradient(135deg, #FEF2F2 0%, #FEE2E2 100%); padding: 12px 14px; border-radius: 8px; border-left: 3px solid #EF4444; margin-bottom: 12px;">
                            <div style="font-size: 0.7rem; font-weight: 700; color: #991B1B; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">⚠️ High Risk Area</div>
                            <div style="font-weight: 600; font-size: 0.85rem; color: #7F1D1D; margin-bottom: 2px;">Narcotic Reconciliation</div>
                            <div style="font-size: 0.75rem; color: #991B1B;">Flagged in 85% of Smith's inspections</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: auto; padding-top: 8px; border-top: 1px solid var(--border-subtle);">
                            <span style="font-size: 0.75rem; color: var(--text-muted);">
                                <i class="fas fa-chart-line"></i> AI Confidence: 92%
                            </span>
                            <span style="color: var(--primary); font-weight: 700; font-size: 0.85rem;">View Profile →</span>
                        </div>
                    </div>

                    <div class="widget-card" onclick="switchView('monitoring', document.querySelectorAll('.nav-item')[4])">
                        <div class="widget-title">
                            <i class="fas fa-chart-line"></i> AI Report Classifier
                        </div>
                        <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 16px; font-weight: 500;">
                            Separate mandatory laws from optional suggestions instantly
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; font-weight: 600; margin-bottom: 8px;">
                                <span style="color: var(--text-main);">Latest: Inspection_Feb05.pdf</span>
                                <span style="font-size: 0.7rem; background: #FEE2E2; color: #991B1B; padding: 3px 8px; border-radius: 4px; font-weight: 700;">9 Findings</span>
                            </div>
                            <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 10px;">
                                <i class="fas fa-check-circle" style="color: var(--accent-green);"></i> Checked against 47 regulations
                            </div>
                            <div style="display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 12px;">
                                <span style="font-size: 0.7rem; padding: 4px 10px; background: #FEE2E2; color: #991B1B; border-radius: 4px; font-weight: 700;">2 LAWS</span>
                                <span style="font-size: 0.7rem; padding: 4px 10px; background: #DBEAFE; color: #1E40AF; border-radius: 4px; font-weight: 700;">4 GUIDELINES</span>
                                <span style="font-size: 0.7rem; padding: 4px 10px; background: #E0F2F1; color: #00695C; border-radius: 4px; font-weight: 700;">3 SUGGESTIONS</span>
                            </div>
                            <div style="background: linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%); border-left: 3px solid #F59E0B; padding: 8px 10px; border-radius: 6px; margin-bottom: 12px;">
                                <div style="font-size: 0.75rem; color: #92400E; font-weight: 600; display: flex; align-items: center; gap: 6px;">
                                    <i class="fas fa-exclamation-circle"></i> 2 critical laws require immediate action
                                </div>
                            </div>
                        </div>
                        <div style="background: #F9FAFB; border-radius: 8px; padding: 12px; margin-top: auto;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-size: 0.75rem; color: var(--text-muted);">
                                    <i class="fas fa-bolt" style="color: var(--accent-orange);"></i> Analyzed in 2.3s
                                </div>
                                <div style="font-size: 0.75rem; color: var(--primary); font-weight: 700;">View Report →</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-studio" class="view-section">
            <div class="studio-container">
                <!-- LEFT: Resources -->
                <div class="studio-sidebar-left">
                    <div class="resources-header">
                        <h3>Sources</h3>
                        <p style="font-size: 0.85rem; color: var(--text-muted); margin: 0;">0 sources</p>
                    </div>
                    <div class="upload-zone" onclick="openModal('uploadModal')">
                        <i class="fas fa-cloud-arrow-up" style="font-size: 2rem; display: block; margin-bottom: 12px;"></i>
                        <div style="font-weight: 600; margin-bottom: 4px;">Upload a source</div>
                        <div style="font-size: 0.8rem;">PDFs, videos, audio, or text</div>
                    </div>
                    <div class="resources-list" id="resourcesList">
                        <div style="text-align: center; color: var(--text-muted); padding: 40px 20px; font-size: 0.9rem;">
                            <i class="fas fa-folder-open" style="font-size: 2rem; display: block; margin-bottom: 12px; opacity: 0.3;"></i>
                            Upload sources to add context for AI generation
                        </div>
                    </div>
                </div>

                <!-- MIDDLE: Chat -->
                <div class="studio-main">
                    <div class="studio-chat-container">
                        <div class="chat-messages" id="studioChat">
                            <div style="text-align: center; padding: 60px 20px;">
                                <div style="font-size: 3rem; color: var(--primary); margin-bottom: 16px;margin-top:100px;"><i class="fas fa-comments"></i></div>
                                <h2 style="font-size: 1.8rem; margin-bottom: 12px;">Content Studio</h2>
                                <p style="color: var(--text-muted); max-width: 500px; margin: 0 auto 32px auto;">Ask questions about your sources or use the tools on the right to generate training materials, reports, and compliance content.</p>
                                
                                <div class="prompt-bar-container" style="max-width: 720px; margin: 0 auto;">
                                    <input type="text" class="prompt-input" id="studioPromptInput" placeholder="Ask about your sources or request content generation..." onkeypress="handleStudioChat(event)" style="padding: 16px 60px 16px 20px;">
                                    <button class="prompt-submit" onclick="sendStudioMessage()"><i class="fas fa-arrow-right"></i></button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- RIGHT: Studio Tools -->
                <div class="studio-sidebar-right">
                    <div class="studio-tools-header">Studio Tools</div>
                    <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 24px;">Generate content from your sources</p>
                    
                    <div class="studio-tool-item" onclick="openToolWizard('audio')">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <div style="width: 36px; height: 36px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-headphones"></i></div>
                            <div style="font-weight: 600; font-size: 0.95rem; flex: 1;">Audio Briefing</div>
                            <i class="fas fa-chevron-right" style="color: var(--text-muted); font-size: 0.8rem;"></i>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0;">5-minute podcast summary</p>
                    </div>

                    <div class="studio-tool-item" onclick="openToolWizard('quiz')">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <div style="width: 36px; height: 36px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-clipboard-question"></i></div>
                            <div style="font-weight: 600; font-size: 0.95rem; flex: 1;">Training Quiz</div>
                            <i class="fas fa-chevron-right" style="color: var(--text-muted); font-size: 0.8rem;"></i>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0;">Interactive knowledge test</p>
                    </div>

                    <div class="studio-tool-item" onclick="openToolWizard('slides')">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <div style="width: 36px; height: 36px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-file-powerpoint"></i></div>
                            <div style="font-weight: 600; font-size: 0.95rem; flex: 1;">Slide Deck</div>
                            <i class="fas fa-chevron-right" style="color: var(--text-muted); font-size: 0.8rem;"></i>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0;">Presentation for meetings</p>
                    </div>

                    <div class="studio-tool-item" onclick="openToolWizard('checklist')">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <div style="width: 36px; height: 36px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-list-check"></i></div>
                            <div style="font-weight: 600; font-size: 0.95rem; flex: 1;">Audit Checklist</div>
                            <i class="fas fa-chevron-right" style="color: var(--text-muted); font-size: 0.8rem;"></i>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0;">Daily compliance tasks</p>
                    </div>
                    
                    <div class="studio-tool-item" onclick="openToolWizard('leaflet')">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <div style="width: 36px; height: 36px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-file-medical"></i></div>
                            <div style="font-weight: 600; font-size: 0.95rem; flex: 1;">Patient Leaflet</div>
                            <i class="fas fa-chevron-right" style="color: var(--text-muted); font-size: 0.8rem;"></i>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0;">Simple language explainer</p>
                    </div>

                    <div class="studio-tool-item" onclick="openToolWizard('incident')">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                            <div style="width: 36px; height: 36px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-file-signature"></i></div>
                            <div style="font-weight: 600; font-size: 0.95rem; flex: 1;">Incident Report</div>
                            <i class="fas fa-chevron-right" style="color: var(--text-muted); font-size: 0.8rem;"></i>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0;">Error documentation form</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-search" class="view-section">
            <div class="gen-ai-container" style="padding-top: 40px;">
                <div class="prompt-bar-container" style="max-width: 800px;">
                    <input type="text" class="prompt-input" id="searchInput" placeholder="Search laws, guidelines, and best practices..." onkeypress="handleSearch(event)">
                    <button class="prompt-submit" onclick="performSearch()"><i class="fas fa-search"></i></button>
                </div>

                <div class="search-results" id="searchResults">
                    <!-- Latest Regulations -->
                    <div style="margin-bottom: 24px;">
                        <h3 style="font-size: 1.2rem; margin-bottom: 16px; color: var(--text-main);">
                            <i class="fas fa-clock" style="color: var(--primary); margin-right: 8px;"></i>
                            Latest Canadian Pharmacy Regulations
                        </h3>
                    </div>

                    <div class="result-card">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <h3 style="margin: 0; flex: 1;">Opioid Agonist Therapy - Mandatory Netcare Verification</h3>
                            <span class="feed-tag tag-law" style="margin-left: 12px;">Law</span>
                        </div>
                        <p style="line-height: 1.6; color: var(--text-main); margin-bottom: 12px;">
                            Effective March 1, 2026, all Alberta pharmacists must verify patient history through Netcare before dispensing opioid agonist therapy medications. This mandatory check aims to prevent duplicate therapy and ensure patient safety.
                        </p>
                        <div style="margin-top: 16px; display: flex; gap: 8px; flex-wrap: wrap;">
                            <span class="source-pill"><i class="fas fa-building"></i> Alberta College of Pharmacy</span>
                            <span class="source-pill"><i class="fas fa-file-alt"></i> Standard 18.2</span>
                            <span class="source-pill"><i class="fas fa-calendar"></i> Published: Jan 15, 2026</span>
                        </div>
                    </div>

                    <div class="result-card">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <h3 style="margin: 0; flex: 1;">Updated Sterile Compounding Standards</h3>
                            <span class="feed-tag tag-guideline" style="margin-left: 12px;">Guideline</span>
                        </div>
                        <p style="line-height: 1.6; color: var(--text-main); margin-bottom: 12px;">
                            NAPRA's Model Standards for Pharmacy Compounding of Non-Hazardous Sterile Preparations have been updated. New requirements include enhanced environmental monitoring and documentation procedures, effective July 1, 2026.
                        </p>
                        <div style="margin-top: 16px; display: flex; gap: 8px; flex-wrap: wrap;">
                            <span class="source-pill"><i class="fas fa-building"></i> NAPRA</span>
                            <span class="source-pill"><i class="fas fa-file-alt"></i> Model Standards v4.1</span>
                            <span class="source-pill"><i class="fas fa-calendar"></i> Published: Dec 20, 2025</span>
                        </div>
                    </div>

                    <div class="result-card">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <h3 style="margin: 0; flex: 1;">Cold Chain Management Requirements</h3>
                            <span class="feed-tag tag-best-practice" style="margin-left: 12px;">Best Practice</span>
                        </div>
                        <p style="line-height: 1.6; color: var(--text-main); margin-bottom: 12px;">
                            Health Canada has updated temperature monitoring requirements for refrigerated medications. Digital temperature logs must be backed up weekly, and all excursions require documented corrective action within 24 hours.
                        </p>
                        <div style="margin-top: 16px; display: flex; gap: 8px; flex-wrap: wrap;">
                            <span class="source-pill"><i class="fas fa-building"></i> Health Canada</span>
                            <span class="source-pill"><i class="fas fa-file-alt"></i> GUI-0001</span>
                            <span class="source-pill"><i class="fas fa-calendar"></i> Published: Nov 10, 2025</span>
                        </div>
                    </div>

                    <div class="result-card">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <h3 style="margin: 0; flex: 1;">Minor Ailments Prescribing - Expanded Scope</h3>
                            <span class="feed-tag tag-guideline" style="margin-left: 12px;">Guideline</span>
                        </div>
                        <p style="line-height: 1.6; color: var(--text-main); margin-bottom: 12px;">
                            Alberta pharmacists can now prescribe for 12 additional minor ailments including UTIs and cold sores. Updated algorithms and documentation requirements are outlined in the new Standard 12.4.
                        </p>
                        <div style="margin-top: 16px; display: flex; gap: 8px; flex-wrap: wrap;">
                            <span class="source-pill"><i class="fas fa-building"></i> ACP</span>
                            <span class="source-pill"><i class="fas fa-file-alt"></i> Standard 12.4</span>
                            <span class="source-pill"><i class="fas fa-calendar"></i> Published: Oct 5, 2025</span>
                        </div>
                    </div>

                    <div class="result-card">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <h3 style="margin: 0; flex: 1;">Continuing Education Requirements 2026</h3>
                            <span class="feed-tag tag-law" style="margin-left: 12px;">Law</span>
                        </div>
                        <p style="line-height: 1.6; color: var(--text-main); margin-bottom: 12px;">
                            Pharmacists must complete 30 CEU credits before license renewal. New mandatory topics include opioid stewardship (2 credits) and cultural competency (2 credits). Renewal window opens February 15, 2026.
                        </p>
                        <div style="margin-top: 16px; display: flex; gap: 8px; flex-wrap: wrap;">
                            <span class="source-pill"><i class="fas fa-building"></i> Alberta College of Pharmacy</span>
                            <span class="source-pill"><i class="fas fa-file-alt"></i> Registration Policy</span>
                            <span class="source-pill"><i class="fas fa-calendar"></i> Published: Sep 1, 2025</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-usecases" class="view-section">
            <div style="max-width: 1200px; margin: 0 auto; padding: 40px; width: 100%;">
                <div class="inspector-header" style="margin-bottom: 48px;">
                    <div>
                        <h2 style="font-size: 2.5rem; margin-bottom: 8px;">How It Works</h2>
                        <p style="color: var(--text-muted); font-size: 1.1rem;">See our three core solutions in action</p>
                    </div>
                </div>

                <!-- Use Case 1: AI Report Classifier -->
                <div style="background: white; border: 2px solid var(--primary-light); border-radius: var(--radius-lg); padding: 40px; margin-bottom: 32px;">
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
                        <div style="width: 64px; height: 64px; background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem;">
                            <i class="fas fa-chart-line" style="color: #991B1B;"></i>
                        </div>
                        <div>
                            <span style="background: #FEE2E2; color: #991B1B; padding: 4px 12px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase;">Solution 01 // Clarity</span>
                            <h3 style="font-size: 1.8rem; margin-top: 8px; font-weight: 700;">AI Report Classifier</h3>
                        </div>
                    </div>
                    
                    <p style="font-size: 1.05rem; color: var(--text-muted); line-height: 1.7; margin-bottom: 32px;">Upload an inspection report and instantly classify every finding, separating mandatory laws from optional suggestions. Stop wasting time on non-issues.</p>
                    
                    <div style="background: #F9FAFB; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-lightbulb" style="color: var(--primary);"></i> How It Works
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">1</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Upload Report</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Drag & drop your PDF inspection report</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">2</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">AI Analysis</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">System checks 47+ regulations in 2.3 seconds</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">3</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Get Results</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">See findings classified as Law, Guideline, or Best Practice</div>
                            </div>
                        </div>
                    </div>

                    <div style="background: white; border: 1px solid var(--border-subtle); border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="font-size: 0.85rem; font-weight: 700; color: var(--text-muted); margin-bottom: 16px; text-transform: uppercase;">Example Classification Results</div>
                        
                        <div style="padding: 16px; border-bottom: 1px solid var(--border-subtle); display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Finding #12: Narcotic Log Signature Missing</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">"Logbook on Dec 12 lacks pharmacist initial..."</div>
                            </div>
                            <span style="background: #FEE2E2; color: #991B1B; padding: 6px 14px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; white-space: nowrap;">LAW - CRITICAL</span>
                        </div>
                        
                        <div style="padding: 16px; border-bottom: 1px solid var(--border-subtle); display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Finding #14: Dusty Shelving Unit</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">"Dust visible on top shelf of medication storage..."</div>
                            </div>
                            <span style="background: #FEF9E7; color: #D97706; padding: 6px 14px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; white-space: nowrap;">GUIDELINE</span>
                        </div>
                        
                        <div style="padding: 16px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Finding #18: Fridge Placement</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">"Suggest moving fridge away from wall for better airflow..."</div>
                            </div>
                            <span style="background: #E0F2F1; color: #00695C; padding: 6px 14px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; white-space: nowrap;">BEST PRACTICE</span>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px;">
                        <button class="btn-primary" onclick="switchView('monitoring', document.querySelectorAll('.nav-item')[4])" style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-chart-line"></i> Try AI Report Classifier
                        </button>
                        <button class="btn-primary" style="background: white; color: var(--primary); border: 2px solid var(--primary); display: flex; align-items: center; gap: 8px;" onclick="showToast('Upload feature coming soon')">
                            <i class="fas fa-upload"></i> Upload Sample Report
                        </button>
                    </div>
                </div>

                <!-- Use Case 2: Auto-Response Generator -->
                <div style="background: white; border: 2px solid var(--primary-light); border-radius: var(--radius-lg); padding: 40px; margin-bottom: 32px;">
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
                        <div style="width: 64px; height: 64px; background: linear-gradient(135deg, #DBEAFE 0%, #BFDBFE 100%); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem;">
                            <i class="fas fa-pen-fancy" style="color: #1E40AF;"></i>
                        </div>
                        <div>
                            <span style="background: #DBEAFE; color: #1E40AF; padding: 4px 12px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase;">Solution 02 // Efficiency</span>
                            <h3 style="font-size: 1.8rem; margin-top: 8px; font-weight: 700;">Auto-Response Generator</h3>
                        </div>
                    </div>
                    
                    <p style="font-size: 1.05rem; color: var(--text-muted); line-height: 1.7; margin-bottom: 32px;">Save 2-3 days of work per inspection. When you receive an inspection report with findings, AI instantly drafts your formal response letter back to the regulator using defensible language and proper citations. This is specifically for responding to inspectors—not general content creation.</p>
                    
                    <div style="background: #F9FAFB; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-lightbulb" style="color: var(--primary);"></i> How It Works
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">1</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Select Finding</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Choose which finding you want to respond to</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">2</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Choose Tone</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Professional, Defensive, or Conciliatory</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">3</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Generate Draft</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">AI writes response citing relevant regulations</div>
                            </div>
                        </div>
                    </div>

                    <div style="background: white; border: 1px solid var(--border-subtle); border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <div style="font-size: 0.85rem; font-weight: 700; color: var(--text-muted); margin-bottom: 16px; text-transform: uppercase;">Example Generated Response</div>
                        
                        <div style="background: #F8FAFC; padding: 24px; border-radius: 8px; font-family: Georgia, serif; font-size: 0.95rem; line-height: 1.8; border-left: 4px solid var(--secondary);">
                            <p style="margin-bottom: 16px;"><strong>RE: Finding #18 (Fridge Log Placement)</strong></p>
                            <p style="margin-bottom: 12px;">We acknowledge the inspector's comment regarding fridge placement near the wall.</p>
                            <p style="margin-bottom: 12px;">However, we note that current Guidelines (Section 4.2) do not mandate specific wall clearance distances provided airflow is maintained. We have verified that airflow is sufficient and respectfully decline to relocate the unit at this time.</p>
                            <p style="margin-bottom: 12px;">Should this become a regulatory requirement in future updates, we will implement changes accordingly.</p>
                            <p style="margin-top: 20px;"><em>Respectfully,</em><br><strong>Dr. Peter</strong><br>Pharmacy Manager</p>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%); border: 1px solid #BAE6FD; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="display: flex; gap: 12px; align-items: start;">
                            <i class="fas fa-shield-check" style="color: #0EA5E9; font-size: 1.5rem;"></i>
                            <div>
                                <div style="font-weight: 700; margin-bottom: 4px;">Eliminates Legal Risk</div>
                                <div style="font-size: 0.95rem; color: #0C4A6E;">Every response cites the correct regulation and uses defensible language that protects your pharmacy from saying the wrong thing.</div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px;">
                        <button class="btn-primary" onclick="openModal('responseModal')" style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-pen"></i> Try Response Generator
                        </button>
                        <button class="btn-primary" style="background: white; color: var(--primary); border: 2px solid var(--primary); display: flex; align-items: center; gap: 8px;" onclick="showToast('Sample response downloaded')">
                            <i class="fas fa-download"></i> Download Sample Response
                        </button>
                    </div>
                </div>

                <!-- Use Case 3: Pre-Inspection Intelligence -->
                <div style="background: white; border: 2px solid var(--primary-light); border-radius: var(--radius-lg); padding: 40px; margin-bottom: 32px;">
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
                        <div style="width: 64px; height: 64px; background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem;">
                            <i class="fas fa-user-secret" style="color: #00695C;"></i>
                        </div>
                        <div>
                            <span style="background: #E0F2F1; color: #00695C; padding: 4px 12px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase;">Solution 03 // Prediction</span>
                            <h3 style="font-size: 1.8rem; margin-top: 8px; font-weight: 700;">Pre-Inspection Intelligence</h3>
                        </div>
                    </div>
                    
                    <p style="font-size: 1.05rem; color: var(--text-muted); line-height: 1.7; margin-bottom: 32px;">Inspectors are creatures of habit. We predict what a specific inspector will look for before they even arrive, giving you targeted preparation guidance.</p>
                    
                    <div style="background: #F9FAFB; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-lightbulb" style="color: var(--primary);"></i> How It Works
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">1</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Inspector Match</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">System identifies your assigned inspector</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">2</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Pattern Analysis</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Analyzes their 45+ past inspection reports</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">3</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Custom Prep</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Get tailored checklist for high-risk areas</div>
                            </div>
                        </div>
                    </div>

                    <div style="background: white; border: 1px solid var(--border-subtle); border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="font-size: 0.85rem; font-weight: 700; color: var(--text-muted); margin-bottom: 16px; text-transform: uppercase;">Example Inspector Profile</div>
                        
                        <div style="display: flex; gap: 16px; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid var(--border-subtle);">
                            <div style="width: 56px; height: 56px; background: #E0F2F1; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 1.2rem; font-weight: 700;">JS</div>
                            <div>
                                <div style="font-weight: 700; font-size: 1.1rem;">Inspector J. Smith</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Lead Inspector • Calgary North Region</div>
                                <div style="font-size: 0.85rem; color: var(--text-muted); margin-top: 4px;">History: 45 Inspections Analyzed</div>
                            </div>
                        </div>

                        <div style="background: #FFF1F2; padding: 16px; border-radius: 8px; border-left: 4px solid #E11D48; margin-bottom: 12px;">
                            <div style="font-size: 0.8rem; font-weight: 700; color: #BE123C; margin-bottom: 6px; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-triangle-exclamation"></i> HIGH RISK AREA
                            </div>
                            <div style="font-size: 0.95rem; color: #881337; line-height: 1.5;">Smith cites <strong>Narcotic Reconciliation</strong> in 85% of visits. Verify your counts and ensure dual signatures before inspection day.</div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                            <div style="background: #FEE2E2; padding: 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #991B1B;">85%</div>
                                <div style="font-size: 0.8rem; color: #991B1B; font-weight: 600;">Narcotics</div>
                            </div>
                            <div style="background: #FEF3C7; padding: 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #92400E;">70%</div>
                                <div style="font-size: 0.8rem; color: #92400E; font-weight: 600;">Temp Logs</div>
                            </div>
                            <div style="background: #DBEAFE; padding: 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.5rem; font-weight: 700; color: #1E40AF;">45%</div>
                                <div style="font-size: 0.8rem; color: #1E40AF; font-weight: 600;">Sterile Comp.</div>
                            </div>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%); border: 1px solid #FDE047; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="display: flex; gap: 12px; align-items: start;">
                            <i class="fas fa-star" style="color: #D97706; font-size: 1.5rem;"></i>
                            <div>
                                <div style="font-weight: 700; margin-bottom: 4px; color: #78350F;">Early Warning System</div>
                                <div style="font-size: 0.95rem; color: #78350F;">Get alerts 7-14 days before inspection. The more reports we analyze, the smarter our predictions become.</div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px;">
                        <button class="btn-primary" onclick="switchView('inspector', document.querySelectorAll('.nav-item')[3])" style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-user-secret"></i> View Inspector Intelligence
                        </button>
                        <button class="btn-primary" style="background: white; color: var(--primary); border: 2px solid var(--primary); display: flex; align-items: center; gap: 8px;" onclick="openModal('inspectorModal')">
                            <i class="fas fa-file-download"></i> Download Prep Checklist
                        </button>
                    </div>
                </div>

                <!-- Use Case 4: Content Studio -->
                <div style="background: white; border: 2px solid var(--primary-light); border-radius: var(--radius-lg); padding: 40px; margin-bottom: 32px;">
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
                        <div style="width: 64px; height: 64px; background: linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem;">
                            <i class="fas fa-shapes" style="color: #6B21A8;"></i>
                        </div>
                        <div>
                            <span style="background: #F3E8FF; color: #6B21A8; padding: 4px 12px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase;">Solution 05 // Creation</span>
                            <h3 style="font-size: 1.8rem; margin-top: 8px; font-weight: 700;">Content Studio</h3>
                        </div>
                    </div>
                    
                    <p style="font-size: 1.05rem; color: var(--text-muted); line-height: 1.7; margin-bottom: 32px;">Proactive training and education tool. Upload regulatory documents (SOPs, guidelines, policies) and instantly transform them into staff training materials, patient education leaflets, knowledge quizzes, and compliance checklists. Perfect for onboarding, continuing education, and keeping your team current—not for responding to inspection findings.</p>
                    
                    <div style="background: #F9FAFB; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-lightbulb" style="color: var(--primary);"></i> How It Works
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">1</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Upload Sources</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Add regulations, SOPs, or training documents</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">2</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Choose Format</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Select quiz, slides, checklist, or leaflet</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">3</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">AI Generates</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Get ready-to-use content in seconds</div>
                            </div>
                        </div>
                    </div>

                    <div style="background: white; border: 1px solid var(--border-subtle); border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="font-size: 0.85rem; font-weight: 700; color: var(--text-muted); margin-bottom: 16px; text-transform: uppercase;">Available Content Types</div>
                        
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                            <div style="padding: 16px; border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-headphones"></i></div>
                                <div>
                                    <div style="font-weight: 600; font-size: 0.95rem;">Audio Briefing</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">5-minute podcast summary</div>
                                </div>
                            </div>
                            
                            <div style="padding: 16px; border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-clipboard-question"></i></div>
                                <div>
                                    <div style="font-weight: 600; font-size: 0.95rem;">Training Quiz</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Interactive knowledge test</div>
                                </div>
                            </div>
                            
                            <div style="padding: 16px; border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-file-powerpoint"></i></div>
                                <div>
                                    <div style="font-weight: 600; font-size: 0.95rem;">Slide Deck</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Presentation for meetings</div>
                                </div>
                            </div>
                            
                            <div style="padding: 16px; border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-list-check"></i></div>
                                <div>
                                    <div style="font-weight: 600; font-size: 0.95rem;">Audit Checklist</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Daily compliance tasks</div>
                                </div>
                            </div>
                            
                            <div style="padding: 16px; border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-file-medical"></i></div>
                                <div>
                                    <div style="font-weight: 600; font-size: 0.95rem;">Patient Leaflet</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Simple language explainer</div>
                                </div>
                            </div>
                            
                            <div style="padding: 16px; border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; background: var(--primary-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary);"><i class="fas fa-file-signature"></i></div>
                                <div>
                                    <div style="font-weight: 600; font-size: 0.95rem;">Incident Report</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted);">Error documentation form</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%); border: 1px solid #D8B4FE; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="display: flex; gap: 12px; align-items: start;">
                            <i class="fas fa-sparkles" style="color: #6B21A8; font-size: 1.5rem;"></i>
                            <div>
                                <div style="font-weight: 700; margin-bottom: 4px; color: #4C1D95;">Consistent Quality</div>
                                <div style="font-size: 0.95rem; color: #4C1D95;">Every piece of content maintains compliance terminology and accuracy while adapting tone for the target audience - from staff training to patient education.</div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px;">
                        <button class="btn-primary" onclick="switchView('studio', document.querySelectorAll('.nav-item')[1])" style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-wand-magic-sparkles"></i> Try Content Studio
                        </button>
                        <button class="btn-primary" style="background: white; color: var(--primary); border: 2px solid var(--primary); display: flex; align-items: center; gap: 8px;" onclick="showToast('Sample content pack downloaded')">
                            <i class="fas fa-download"></i> Download Sample Content
                        </button>
                    </div>
                </div>

                <!-- Use Case 5: Regulatory Search -->
                <div style="background: white; border: 2px solid var(--primary-light); border-radius: var(--radius-lg); padding: 40px; margin-bottom: 32px;">
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
                        <div style="width: 64px; height: 64px; background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem;">
                            <i class="fas fa-search" style="color: #92400E;"></i>
                        </div>
                        <div>
                            <span style="background: #FEF3C7; color: #92400E; padding: 4px 12px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase;">Solution 04 // Knowledge</span>
                            <h3 style="font-size: 1.8rem; margin-top: 8px; font-weight: 700;">Regulatory Search</h3>
                        </div>
                    </div>
                    
                    <p style="font-size: 1.05rem; color: var(--text-muted); line-height: 1.7; margin-bottom: 32px;">Instantly search through thousands of Canadian pharmacy laws, guidelines, and best practices. Find the exact regulation you need in seconds instead of hours of manual research.</p>
                    
                    <div style="background: #F9FAFB; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <h4 style="font-size: 1rem; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-lightbulb" style="color: var(--primary);"></i> How It Works
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">1</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Search Query</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Type your question in natural language</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">2</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">AI Analysis</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">System searches across all regulatory sources</div>
                            </div>
                            <div>
                                <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; margin-bottom: 12px;">3</div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Instant Results</div>
                                <div style="font-size: 0.9rem; color: var(--text-muted);">Get relevant laws with source citations</div>
                            </div>
                        </div>
                    </div>

                    <div style="background: white; border: 1px solid var(--border-subtle); border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="font-size: 0.85rem; font-weight: 700; color: var(--text-muted); margin-bottom: 16px; text-transform: uppercase;">Example Search Results</div>
                        
                        <div style="padding: 16px; border-bottom: 1px solid var(--border-subtle);">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Opioid Agonist Therapy - Netcare Verification</div>
                                <span style="background: #FEE2E2; color: #991B1B; padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700;">LAW</span>
                            </div>
                            <div style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.6;">Mandatory Netcare check required before dispensing OAT medications effective March 1, 2026.</div>
                            <div style="margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap;">
                                <span style="font-size: 0.75rem; padding: 4px 10px; background: var(--bg-subtle); border-radius: 6px;"><i class="fas fa-building" style="margin-right: 4px;"></i>Alberta College of Pharmacy</span>
                                <span style="font-size: 0.75rem; padding: 4px 10px; background: var(--bg-subtle); border-radius: 6px;"><i class="fas fa-file-alt" style="margin-right: 4px;"></i>Standard 18.2</span>
                            </div>
                        </div>
                        
                        <div style="padding: 16px;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Cold Chain Management Requirements</div>
                                <span style="background: #E0F2F1; color: #00695C; padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700;">BEST PRACTICE</span>
                            </div>
                            <div style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.6;">Digital temperature logs must be backed up weekly with documented corrective action within 24 hours.</div>
                            <div style="margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap;">
                                <span style="font-size: 0.75rem; padding: 4px 10px; background: var(--bg-subtle); border-radius: 6px;"><i class="fas fa-building" style="margin-right: 4px;"></i>Health Canada</span>
                                <span style="font-size: 0.75rem; padding: 4px 10px; background: var(--bg-subtle); border-radius: 6px;"><i class="fas fa-file-alt" style="margin-right: 4px;"></i>GUI-0001</span>
                            </div>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, #FFFBEB 0%, #FEF3C7 100%); border: 1px solid #FDE047; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <div style="display: flex; gap: 12px; align-items: start;">
                            <i class="fas fa-bolt" style="color: #D97706; font-size: 1.5rem;"></i>
                            <div>
                                <div style="font-weight: 700; margin-bottom: 4px; color: #78350F;">Always Up-to-Date</div>
                                <div style="font-size: 0.95rem; color: #78350F;">Our knowledge base is continuously updated with the latest regulations from NAPRA, provincial colleges, and Health Canada.</div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 12px;">
                        <button class="btn-primary" onclick="switchView('search', document.querySelectorAll('.nav-item')[2])" style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-search"></i> Try Regulatory Search
                        </button>
                        <button class="btn-primary" style="background: white; color: var(--primary); border: 2px solid var(--primary); display: flex; align-items: center; gap: 8px;" onclick="showToast('Recent updates downloaded')">
                            <i class="fas fa-download"></i> View Recent Updates
                        </button>
                    </div>
                </div>



            </div>
        </section>

        <section id="view-inspector" class="view-section">
            <div style="max-width: 1400px; margin: 0 auto; padding: 48px; width: 100%;">
                <div class="inspector-header" style="margin-bottom: 40px;">
                    <div>
                        <h2 style="font-size: 2.25rem; margin-bottom: 8px; font-weight: 800; letter-spacing: -0.5px; color: var(--text-main);">Pre-Inspection Intelligence</h2>
                        <p style="color: var(--text-muted); font-size: 1.05rem;">Predictive insights powered by AI for your next audit</p>
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <div class="user-pill" style="background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 10px 18px; font-weight: 600;"><i class="fas fa-calendar" style="color: var(--primary);"></i> Next Audit: Feb 12</div>
                        <button class="btn-primary" style="padding: 10px 20px; font-size: 0.9rem; box-shadow: 0 4px 12px rgba(0, 105, 92, 0.25); transition: all 0.2s;" onclick="openModal('inspectorModal')" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0, 105, 92, 0.35)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0, 105, 92, 0.25)'">
                            <i class="fas fa-download"></i> Prep Checklist
                        </button>
                    </div>
                </div>

                <!-- Top Alert Banner -->
                <div style="background: linear-gradient(135deg, #FEF2F2 0%, #FEE2E2 100%); padding: 24px 28px; border-radius: 16px; border: 2px solid #FECACA; margin-bottom: 36px; display: flex; align-items: center; gap: 20px; box-shadow: 0 4px 20px rgba(239, 68, 68, 0.15); position: relative; overflow: hidden;">
                    <div style="position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: rgba(255, 255, 255, 0.4); border-radius: 50%; filter: blur(20px);"></div>
                    <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.4rem; flex-shrink: 0; box-shadow: 0 4px 16px rgba(239, 68, 68, 0.3); position: relative; z-index: 1;">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div style="flex: 1; position: relative; z-index: 1;">
                        <div style="font-weight: 800; font-size: 1.1rem; margin-bottom: 6px; color: #991B1B; letter-spacing: -0.3px;">High Priority: Narcotic Reconciliation Gap Detected</div>
                        <div style="color: #7F1D1D; font-size: 0.95rem; line-height: 1.5;">Inspector J. Smith flagged this in 85% of recent audits. Review your narcotic log for Dec 12-18.</div>
                    </div>
                    <button class="btn-primary" style="background: linear-gradient(135deg, #991B1B 0%, #7F1D1D 100%); padding: 12px 24px; font-size: 0.9rem; white-space: nowrap; box-shadow: 0 4px 12px rgba(153, 27, 27, 0.25); position: relative; z-index: 1; transition: all 0.2s; font-weight: 700;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(153, 27, 27, 0.35)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(153, 27, 27, 0.25)'">Review Now</button>
                </div>

                <!-- Main Grid -->
                <div style="display: grid; grid-template-columns: 320px 1fr 320px; gap: 24px; margin-bottom: 32px; align-items: stretch;">
                    
                    <!-- Left: Inspector Profile -->
                    <div class="profile-panel" style="box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 24px rgba(0, 0, 0, 0.06)'">
                        <div style="text-align: center; margin-bottom: 24px;">
                            <div style="width: 96px; height: 96px; background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 2rem; font-weight: 800; margin: 0 auto 16px; box-shadow: 0 8px 24px rgba(0, 105, 92, 0.15); border: 3px solid white;">JS</div>
                            <h3 style="margin: 0 0 6px 0; font-size: 1.2rem; font-weight: 800; letter-spacing: -0.3px;">Inspector J. Smith</h3>
                            <p style="color: var(--text-muted); font-size: 0.9rem; margin: 0; font-weight: 500;">Lead Inspector • Calgary North</p>
                        </div>

                        <div class="detail-row">
                            <span class="detail-label">Last Audit</span>
                            <span class="detail-value">Jan 15, 2026</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Verdict</span>
                            <span class="detail-value" style="color: #F59E0B;">Conditional Pass</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Audits</span>
                            <span class="detail-value">8</span>
                        </div>
                        <div class="detail-row" style="border: none;">
                            <span class="detail-label">Avg. Duration</span>
                            <span class="detail-value">2.5 hours</span>
                        </div>

                        <div style="margin-top: 24px; padding-top: 20px; border-top: 1px solid var(--border-subtle);">
                            <h4 style="font-size: 0.9rem; margin-bottom: 12px; color: var(--text-muted); font-weight: 700;">RECENT CITATIONS</h4>
                            <div style="font-size: 0.85rem; margin-bottom: 8px;">• Narcotic Log (3 times)</div>
                            <div style="font-size: 0.85rem; margin-bottom: 8px;">• Temperature Records (2 times)</div>
                            <div style="font-size: 0.85rem;">• Sterile Compounding (1 time)</div>
                        </div>

                        <button class="btn-primary" style="width: 100%; margin-top: 20px; background: white; color: var(--primary); border: 1px solid var(--border-subtle);" onclick="openModal('inspectorModal')">
                            View Full Profile
                        </button>
                    </div>

                    <!-- Middle: Focus Areas Chart -->
                    <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                        <div style="background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 28px; box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06); transition: all 0.3s; flex: 1; display: flex; flex-direction: column;" onmouseover="this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.boxShadow='0 4px 24px rgba(0, 0, 0, 0.06)'">
                            <h3 style="font-size: 1.2rem; margin-bottom: 8px; font-weight: 800; letter-spacing: -0.3px;">Historical Focus Areas</h3>
                            <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 24px; font-weight: 500;">Based on 20 recent audits by this inspector</p>
                            
                            <div class="chart-container" style="flex: 1; min-height: 200px; padding: 24px;">
                                <div class="bar-group"><div class="bar" data-val="85%" style="height: 85%; background: #EF4444;"></div><span style="font-size: 0.75rem; color: var(--text-muted); margin-top: 8px;">Narcotics</span></div>
                                <div class="bar-group"><div class="bar" data-val="70%" style="height: 70%; background: #F59E0B;"></div><span style="font-size: 0.75rem; color: var(--text-muted); margin-top: 8px;">Temp Logs</span></div>
                                <div class="bar-group"><div class="bar" data-val="45%" style="height: 45%; background: #10B981;"></div><span style="font-size: 0.75rem; color: var(--text-muted); margin-top: 8px;">Sterile</span></div>
                                <div class="bar-group"><div class="bar" data-val="38%" style="height: 38%; background: #3B82F6;"></div><span style="font-size: 0.75rem; color: var(--text-muted); margin-top: 8px;">Records</span></div>
                                <div class="bar-group"><div class="bar" data-val="25%" style="height: 25%; background: #8B5CF6;"></div><span style="font-size: 0.75rem; color: var(--text-muted); margin-top: 8px;">Security</span></div>
                            </div>
                        </div>

                        <!-- Audit History Trend -->
                        <div style="background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 28px; box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06); transition: all 0.3s; flex: 1; display: flex; flex-direction: column;" onmouseover="this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.boxShadow='0 4px 24px rgba(0, 0, 0, 0.06)'">
                            <h3 style="font-size: 1.2rem; margin-bottom: 8px; font-weight: 800; letter-spacing: -0.3px;">Your Audit Performance Trend</h3>
                            <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 24px; font-weight: 500;">Last 4 inspections with J. Smith</p>
                            
                            <div style="display: flex; gap: 16px; align-items: flex-end; height: 120px;">
                                <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px; height: 100%; justify-content: flex-end;">
                                    <div style="width: 100%; height: 55%; background: #FEE2E2; border-radius: 8px 8px 0 0; position: relative;">
                                        <span style="position: absolute; top: -22px; left: 50%; transform: translateX(-50%); font-size: 0.85rem; font-weight: 700; color: #991B1B;">55%</span>
                                    </div>
                                    <span style="font-size: 0.75rem; color: var(--text-muted);">Jan 2024</span>
                                </div>
                                <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px; height: 100%; justify-content: flex-end;">
                                    <div style="width: 100%; height: 68%; background: #FED7AA; border-radius: 8px 8px 0 0; position: relative;">
                                        <span style="position: absolute; top: -22px; left: 50%; transform: translateX(-50%); font-size: 0.85rem; font-weight: 700; color: #C2410C;">68%</span>
                                    </div>
                                    <span style="font-size: 0.75rem; color: var(--text-muted);">Jul 2024</span>
                                </div>
                                <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px; height: 100%; justify-content: flex-end;">
                                    <div style="width: 100%; height: 75%; background: #FDE68A; border-radius: 8px 8px 0 0; position: relative;">
                                        <span style="position: absolute; top: -22px; left: 50%; transform: translateX(-50%); font-size: 0.85rem; font-weight: 700; color: #92400E;">75%</span>
                                    </div>
                                    <span style="font-size: 0.75rem; color: var(--text-muted);">Nov 2025</span>
                                </div>
                                <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px; height: 100%; justify-content: flex-end;">
                                    <div style="width: 100%; height: 85%; background: #D1FAE5; border-radius: 8px 8px 0 0; position: relative;">
                                        <span style="position: absolute; top: -22px; left: 50%; transform: translateX(-50%); font-size: 0.85rem; font-weight: 700; color: #065F46;">85%</span>
                                    </div>
                                    <span style="font-size: 0.75rem; color: var(--text-muted);">Jan 2026</span>
                                </div>
                            </div>
                            
                            <div style="margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 8px; color: #065F46;">
                                <i class="fas fa-arrow-trend-up"></i>
                                <span style="font-weight: 600; font-size: 0.9rem;">+30% improvement over 2 years</span>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Action Items & Quick Stats -->
                    <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                        
                        <!-- Quick Stats -->
                        <div style="background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06); transition: all 0.3s;" onmouseover="this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.boxShadow='0 4px 24px rgba(0, 0, 0, 0.06)'">
                            <h4 style="font-size: 1rem; margin-bottom: 20px; font-weight: 800; letter-spacing: -0.3px;">Quick Stats</h4>
                            
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                    <span style="font-size: 0.85rem; color: var(--text-muted);">Days Until Audit</span>
                                    <span style="font-weight: 700; font-size: 1.2rem; color: #EF4444;">6</span>
                                </div>
                            </div>

                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                    <span style="font-size: 0.85rem; color: var(--text-muted);">Open Findings</span>
                                    <span style="font-weight: 700; font-size: 1.2rem; color: #F59E0B;">2</span>
                                </div>
                            </div>

                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                    <span style="font-size: 0.85rem; color: var(--text-muted);">Readiness Score</span>
                                    <span style="font-weight: 700; font-size: 1.2rem; color: #10B981;">78%</span>
                                </div>
                                <div class="progress-container">
                                    <div class="progress-fill" style="width: 78%; background: #10B981;"></div>
                                </div>
                            </div>

                            <div>
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                    <span style="font-size: 0.85rem; color: var(--text-muted);">Documents Ready</span>
                                    <span style="font-weight: 700; font-size: 1.2rem;">12/15</span>
                                </div>
                                <div class="progress-container">
                                    <div class="progress-fill" style="width: 80%;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Items -->
                        <div style="background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06); transition: all 0.3s;" onmouseover="this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.boxShadow='0 4px 24px rgba(0, 0, 0, 0.06)'">
                            <h4 style="font-size: 1rem; margin-bottom: 20px; font-weight: 800; letter-spacing: -0.3px;">Priority Actions</h4>
                            
                            <div style="padding: 12px; background: #FEF2F2; border-left: 3px solid #EF4444; border-radius: 6px; margin-bottom: 12px;">
                                <div style="font-weight: 600; font-size: 0.85rem; margin-bottom: 4px; color: #991B1B;">
                                    <i class="fas fa-circle" style="font-size: 0.5rem; margin-right: 6px;"></i>Review Narcotic Logs
                                </div>
                                <div style="font-size: 0.75rem; color: #7F1D1D;">Due: Feb 8 (2 days)</div>
                            </div>

                            <div style="padding: 12px; background: #FEF9E7; border-left: 3px solid #F59E0B; border-radius: 6px; margin-bottom: 12px;">
                                <div style="font-weight: 600; font-size: 0.85rem; margin-bottom: 4px; color: #92400E;">
                                    <i class="fas fa-circle" style="font-size: 0.5rem; margin-right: 6px;"></i>Upload Temp Records
                                </div>
                                <div style="font-size: 0.75rem; color: #78350F;">Due: Feb 9 (3 days)</div>
                            </div>

                            <div style="padding: 12px; background: #F0F9FF; border-left: 3px solid #3B82F6; border-radius: 6px;">
                                <div style="font-weight: 600; font-size: 0.85rem; margin-bottom: 4px; color: #1E40AF;">
                                    <i class="fas fa-circle" style="font-size: 0.5rem; margin-right: 6px;"></i>Staff Training Records
                                </div>
                                <div style="font-size: 0.75rem; color: #1E3A8A;">Due: Feb 10 (4 days)</div>
                            </div>
                        </div>

                        <!-- Peer Comparison -->
                        <div style="background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px; box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06); transition: all 0.3s;" onmouseover="this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.boxShadow='0 4px 24px rgba(0, 0, 0, 0.06)'">
                            <h4 style="font-size: 1rem; margin-bottom: 8px; font-weight: 800; letter-spacing: -0.3px;">Peer Comparison</h4>
                            <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 20px; font-weight: 500;">Similar pharmacies in your region</p>
                            
                            <div style="margin-bottom: 12px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span style="font-size: 0.85rem;">Your Score</span>
                                    <span style="font-weight: 700; color: #10B981;">85%</span>
                                </div>
                                <div class="progress-container" style="background: #D1FAE5;">
                                    <div class="progress-fill" style="width: 85%; background: #10B981;"></div>
                                </div>
                            </div>

                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span style="font-size: 0.85rem;">Peer Average</span>
                                    <span style="font-weight: 700; color: #6B7280;">72%</span>
                                </div>
                                <div class="progress-container">
                                    <div class="progress-fill" style="width: 72%; background: #9CA3AF;"></div>
                                </div>
                            </div>

                            <div style="margin-top: 16px; padding: 10px; background: #ECFDF5; border-radius: 6px; text-align: center;">
                                <i class="fas fa-trophy" style="color: #10B981; margin-right: 6px;"></i>
                                <span style="font-size: 0.85rem; font-weight: 600; color: #065F46;">Above Average</span>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Tailored Prep Section -->
                <div style="background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); border: 2px solid var(--primary); border-radius: 20px; padding: 40px; margin-bottom: 40px; position: relative; overflow: hidden; box-shadow: 0 8px 32px rgba(0, 105, 92, 0.15);">
                    <!-- Decorative Elements -->
                    <div style="position: absolute; top: -40px; right: -40px; width: 180px; height: 180px; background: rgba(255, 255, 255, 0.3); border-radius: 50%; filter: blur(40px);"></div>
                    <div style="position: absolute; bottom: -60px; left: -60px; width: 200px; height: 200px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; filter: blur(50px);"></div>
                    
                    <div style="position: relative; z-index: 1;">
                        <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 32px;">
                            <div style="width: 64px; height: 64px; background: linear-gradient(135deg, var(--primary) 0%, #004D40 100%); border-radius: 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.6rem; box-shadow: 0 8px 24px rgba(0, 105, 92, 0.4); border: 3px solid rgba(255, 255, 255, 0.5);">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div>
                                <h3 style="font-size: 1.6rem; margin: 0 0 6px 0; color: var(--primary-dark); font-weight: 900; letter-spacing: -0.5px;">Tailored Prep for Inspector J. Smith</h3>
                                <p style="margin: 0; color: #00695C; font-size: 1rem; font-weight: 600;">Custom checklist based on 85% narcotic focus pattern + your history</p>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px;">
                            
                            <!-- Checklist Item 1 -->
                            <div style="background: white; border-radius: 16px; padding: 24px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); transition: all 0.3s; border: 2px solid transparent;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.12)'; this.style.borderColor='#FECACA'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.08)'; this.style.borderColor='transparent'">
                                <div style="display: flex; align-items: start; gap: 14px; margin-bottom: 16px;">
                                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);">
                                        <i class="fas fa-pills" style="color: #EF4444; font-size: 1.1rem;"></i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 800; font-size: 1.05rem; margin-bottom: 6px; color: var(--text-main); letter-spacing: -0.3px;">Narcotic Log Audit</div>
                                        <div style="font-size: 0.75rem; color: #EF4444; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">Critical Priority</div>
                                    </div>
                                </div>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.85rem; color: var(--text-muted); line-height: 1.8;">
                                    <li>Verify all entries Dec 12-18</li>
                                    <li>Check dual signatures present</li>
                                    <li>Confirm daily counts match</li>
                                    <li>Review destruction records</li>
                                </ul>
                                <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border-subtle); font-size: 0.75rem; color: var(--text-muted);">
                                    <i class="fas fa-chart-line"></i> Flagged in 85% of Smith's audits
                                </div>
                            </div>

                            <!-- Checklist Item 2 -->
                            <div style="background: white; border-radius: 16px; padding: 24px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); transition: all 0.3s; border: 2px solid transparent;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.12)'; this.style.borderColor='#FDE68A'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.08)'; this.style.borderColor='transparent'">
                                <div style="display: flex; align-items: start; gap: 14px; margin-bottom: 16px;">
                                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);">
                                        <i class="fas fa-temperature-half" style="color: #F59E0B; font-size: 1.1rem;"></i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 800; font-size: 1.05rem; margin-bottom: 6px; color: var(--text-main); letter-spacing: -0.3px;">Cold Chain Verification</div>
                                        <div style="font-size: 0.75rem; color: #F59E0B; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">High Priority</div>
                                    </div>
                                </div>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.85rem; color: var(--text-muted); line-height: 1.8;">
                                    <li>Ensure 2°C - 8°C compliance</li>
                                    <li>Check AM/PM log completeness</li>
                                    <li>Verify calibration certificates</li>
                                    <li>Document corrective actions</li>
                                </ul>
                                <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border-subtle); font-size: 0.75rem; color: var(--text-muted);">
                                    <i class="fas fa-chart-line"></i> Flagged in 70% of Smith's audits
                                </div>
                            </div>

                            <!-- Checklist Item 3 -->
                            <div style="background: white; border-radius: 16px; padding: 24px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); transition: all 0.3s; border: 2px solid transparent;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 12px 32px rgba(0, 0, 0, 0.12)'; this.style.borderColor='#BFDBFE'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 20px rgba(0, 0, 0, 0.08)'; this.style.borderColor='transparent'">
                                <div style="display: flex; align-items: start; gap: 14px; margin-bottom: 16px;">
                                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #DBEAFE 0%, #BFDBFE 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);">
                                        <i class="fas fa-flask" style="color: #3B82F6; font-size: 1.1rem;"></i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 800; font-size: 1.05rem; margin-bottom: 6px; color: var(--text-main); letter-spacing: -0.3px;">Sterile Compounding</div>
                                        <div style="font-size: 0.75rem; color: #3B82F6; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;">Medium Priority</div>
                                    </div>
                                </div>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.85rem; color: var(--text-muted); line-height: 1.8;">
                                    <li>Review aseptic technique logs</li>
                                    <li>Check staff competency dates</li>
                                    <li>Verify BUD calculations</li>
                                    <li>Inspect cleanroom records</li>
                                </ul>
                                <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border-subtle); font-size: 0.75rem; color: var(--text-muted);">
                                    <i class="fas fa-chart-line"></i> Flagged in 45% of Smith's audits
                                </div>
                            </div>

                        </div>

                        <div style="display: flex; gap: 16px; justify-content: center;">
                            <button class="btn-primary" style="padding: 14px 32px; font-size: 1rem; display: flex; align-items: center; gap: 10px; box-shadow: 0 6px 20px rgba(0, 105, 92, 0.3); font-weight: 700; transition: all 0.2s;" onclick="startGeneration('Custom Audit Prep Checklist', 'checklist')" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 28px rgba(0, 105, 92, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 20px rgba(0, 105, 92, 0.3)'">
                                <i class="fas fa-file-download"></i> Download Full Checklist (PDF)
                            </button>
                            <button class="btn-primary" style="padding: 14px 32px; font-size: 1rem; display: flex; align-items: center; gap: 10px; background: white; color: var(--primary); border: 3px solid var(--primary); font-weight: 700; box-shadow: 0 4px 16px rgba(0, 105, 92, 0.15); transition: all 0.2s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.background='var(--primary-light)'; this.style.boxShadow='0 6px 24px rgba(0, 105, 92, 0.25)'" onmouseout="this.style.transform='translateY(0)'; this.style.background='white'; this.style.boxShadow='0 4px 16px rgba(0, 105, 92, 0.15)'">
                                <i class="fas fa-sparkles"></i> Generate Action Plan
                            </button>
                        </div>

                        <div style="margin-top: 28px; padding: 20px 24px; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); border-radius: 12px; display: flex; align-items: center; gap: 16px; border: 2px solid rgba(255, 255, 255, 0.5); box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);">
                            <i class="fas fa-lightbulb" style="color: #F59E0B; font-size: 1.4rem;"></i>
                            <div style="font-size: 0.9rem; color: #00695C; font-weight: 500; line-height: 1.6;">
                                <strong style="font-weight: 800;">Pro Tip:</strong> Based on your last audit's conditional pass, Smith will likely re-verify the narcotic reconciliation process. Prepare evidence of implemented corrective actions.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Evidence Repository -->
                <div style="background: white; border: 1px solid var(--border-subtle); border-radius: 20px; padding: 32px; box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 28px;">
                        <div>
                            <h3 style="font-size: 1.3rem; margin-bottom: 6px; font-weight: 800; letter-spacing: -0.3px;">Compliance Evidence Repository</h3>
                            <p style="color: var(--text-muted); font-size: 0.95rem; margin: 0; font-weight: 500;">Documents ready for inspection</p>
                        </div>
                        <button class="btn-primary" style="padding: 12px 24px; font-size: 0.9rem; box-shadow: 0 4px 16px rgba(0, 105, 92, 0.25); font-weight: 700; transition: all 0.2s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 24px rgba(0, 105, 92, 0.35)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 16px rgba(0, 105, 92, 0.25)'">
                            <i class="fas fa-upload"></i> Upload Document
                        </button>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;">
                        
                        <div style="border: 2px solid var(--border-subtle); border-radius: 12px; padding: 20px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 12px rgba(0, 0, 0, 0.04); background: white;" onmouseover="this.style.borderColor='var(--primary)'; this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px rgba(0, 0, 0, 0.1)'" onmouseout="this.style.borderColor='var(--border-subtle)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 12px rgba(0, 0, 0, 0.04)'">
                            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 16px; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.15);">
                                <i class="fas fa-file-pdf" style="color: #EF4444; font-size: 1.3rem;"></i>
                            </div>
                            <div style="font-weight: 800; font-size: 0.95rem; margin-bottom: 6px; letter-spacing: -0.2px;">Narcotic Logs</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">Updated Jan 31</div>
                            <div style="margin-top: 8px;">
                                <span style="font-size: 0.7rem; padding: 2px 8px; background: #DCFCE7; color: #166534; border-radius: 4px; font-weight: 600;">VERIFIED</span>
                            </div>
                        </div>

                        <div style="border: 1px solid var(--border-subtle); border-radius: 8px; padding: 16px; cursor: pointer; transition: 0.2s;" onmouseover="this.style.borderColor='var(--primary)'" onmouseout="this.style.borderColor='var(--border-subtle)'">
                            <div style="width: 40px; height: 40px; background: #DBEAFE; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 12px;">
                                <i class="fas fa-temperature-half" style="color: #3B82F6; font-size: 1.2rem;"></i>
                            </div>
                            <div style="font-weight: 600; font-size: 0.9rem; margin-bottom: 4px;">Temp Logs</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Updated Feb 6</div>
                            <div style="margin-top: 8px;">
                                <span style="font-size: 0.7rem; padding: 2px 8px; background: #DCFCE7; color: #166534; border-radius: 4px; font-weight: 600;">VERIFIED</span>
                            </div>
                        </div>

                        <div style="border: 1px solid var(--border-subtle); border-radius: 8px; padding: 16px; cursor: pointer; transition: 0.2s;" onmouseover="this.style.borderColor='var(--primary)'" onmouseout="this.style.borderColor='var(--border-subtle)'">
                            <div style="width: 40px; height: 40px; background: #E0F2F1; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 12px;">
                                <i class="fas fa-graduation-cap" style="color: var(--primary); font-size: 1.2rem;"></i>
                            </div>
                            <div style="font-weight: 600; font-size: 0.9rem; margin-bottom: 4px;">Training Records</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Updated Dec 15</div>
                            <div style="margin-top: 8px;">
                                <span style="font-size: 0.7rem; padding: 2px 8px; background: #FEF3C7; color: #92400E; border-radius: 4px; font-weight: 600;">REVIEW</span>
                            </div>
                        </div>

                        <div style="border: 1px dashed var(--border-subtle); border-radius: 8px; padding: 16px; cursor: pointer; transition: 0.2s; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; min-height: 120px;" onmouseover="this.style.borderColor='var(--primary)'; this.style.background='var(--primary-light)'" onmouseout="this.style.borderColor='var(--border-subtle)'; this.style.background='transparent'">
                            <i class="fas fa-plus-circle" style="font-size: 2rem; color: var(--text-muted); margin-bottom: 8px;"></i>
                            <div style="font-weight: 600; font-size: 0.9rem; color: var(--text-muted);">Add Document</div>
                        </div>

                    </div>
                </div>

            </div>
        </section>

        <section id="view-monitoring" class="view-section">
            <div style="max-width: 1400px; margin: 0 auto; padding: 40px; width: 100%;">
                <div class="inspector-header">
                    <div>
                        <h2 style="font-size: 2rem; margin-bottom: 8px;">AI Report Classifier</h2>
                        <p style="color: var(--text-muted);">Instant classification of inspection findings with AI-powered analysis</p>
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button class="btn-primary" style="background: white; color: var(--primary); border: 2px solid var(--primary); padding: 10px 20px; font-size: 0.85rem;"><i class="fas fa-upload"></i> Upload New Report</button>
                        <button class="btn-primary" style="padding: 10px 20px; font-size: 0.85rem;"><i class="fas fa-download"></i> Export All</button>
                    </div>
                </div>

                <!-- Header Card with File Info -->
                <div style="background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%); border: 2px solid var(--primary); border-radius: var(--radius-lg); padding: 32px; margin-bottom: 32px;">
                    <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 24px;">
                        <div style="width: 64px; height: 64px; background: var(--primary); border-radius: 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.8rem;">
                            <i class="fas fa-file-contract"></i>
                        </div>
                        <div style="flex: 1;">
                            <h3 style="font-size: 1.5rem; margin-bottom: 4px;">AI Report Classification</h3>
                            <p style="color: var(--text-muted); font-size: 0.95rem;">Inspection_Feb05.pdf • Uploaded & Processed Feb 5, 2026</p>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 4px;">AI Confidence</div>
                            <div style="font-size: 2rem; font-weight: 700; color: var(--accent-green);">94%</div>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;">
                        <div style="background: #FEF2F2; padding: 16px; border-radius: 12px; border: 1px solid #FECACA; text-align: center;">
                            <div style="font-size: 0.8rem; color: #991B1B; margin-bottom: 4px; font-weight: 600;">TOTAL FINDINGS</div>
                            <div style="font-size: 2rem; font-weight: 700; color: #991B1B;">8</div>
                        </div>
                        <div style="background: #FEE2E2; padding: 16px; border-radius: 12px; border: 1px solid #FECACA; text-align: center;">
                            <div style="font-size: 0.8rem; color: #EF4444; margin-bottom: 4px; font-weight: 600;">LAWS (CRITICAL)</div>
                            <div style="font-size: 2rem; font-weight: 700; color: #EF4444;">3</div>
                        </div>
                        <div style="background: #FEF9E7; padding: 16px; border-radius: 12px; border: 1px solid #FDE68A; text-align: center;">
                            <div style="font-size: 0.8rem; color: #D97706; margin-bottom: 4px; font-weight: 600;">GUIDELINES</div>
                            <div style="font-size: 2rem; font-weight: 700; color: #F59E0B;">3</div>
                        </div>
                        <div style="background: #F0F9FF; padding: 16px; border-radius: 12px; border: 1px solid #BAE6FD; text-align: center;">
                            <div style="font-size: 0.8rem; color: #0369A1; margin-bottom: 4px; font-weight: 600;">BEST PRACTICES</div>
                            <div style="font-size: 2rem; font-weight: 700; color: #0EA5E9;">2</div>
                        </div>
                    </div>
                </div>

                <!-- Document Details & Actions -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px;">
                    <!-- Document Metadata -->
                    <div style="background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px;">
                        <h4 style="margin: 0 0 16px 0; font-size: 1rem; font-weight: 700;">Document Details</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; font-size: 0.9rem;">
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-subtle);">
                                <span style="color: var(--text-muted);">File Name</span>
                                <span style="font-weight: 600;">Inspection_Feb05.pdf</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-subtle);">
                                <span style="color: var(--text-muted);">Pages Analyzed</span>
                                <span style="font-weight: 600;">15 pages</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-subtle);">
                                <span style="color: var(--text-muted);">Upload Date</span>
                                <span style="font-weight: 600;">Feb 5, 2026</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-subtle);">
                                <span style="color: var(--text-muted);">Processing Time</span>
                                <span style="font-weight: 600;">2.3 seconds</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-subtle);">
                                <span style="color: var(--text-muted);">Regulations Checked</span>
                                <span style="font-weight: 600;">47 standards</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-subtle);">
                                <span style="color: var(--text-muted);">Last Updated</span>
                                <span style="font-weight: 600;">2 hours ago</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div style="background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 24px;">
                        <h4 style="margin: 0 0 16px 0; font-size: 1rem; font-weight: 700;">Quick Actions</h4>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <button class="btn-primary" style="width: 100%; padding: 12px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <i class="fas fa-file-pdf"></i> View Original PDF
                            </button>
                            <button class="btn-primary" style="width: 100%; background: white; color: var(--primary); border: 2px solid var(--primary); padding: 12px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <i class="fas fa-download"></i> Export Report
                            </button>
                            <button class="btn-primary" style="width: 100%; background: var(--accent-green); padding: 12px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <i class="fas fa-magic"></i> Generate All Responses
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Findings List -->
                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 1.2rem; margin-bottom: 20px; margin-top: 20px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-exclamation-circle" style="color: #EF4444;"></i> Detected Issues
                    </h3>

                    <!-- Issue 1 -->
                    <div style="background: white; border: 1px solid #FECACA; border-left: 4px solid #EF4444; border-radius: 12px; padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow-card);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <span style="background: #FEE2E2; color: #991B1B; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700;">Law - Critical</span>
                                    <span style="background: #F3F4F6; color: #4B5563; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 600;">Page 4, Para 2</span>
                                </div>
                                <h4 style="font-size: 1.1rem; margin-bottom: 8px; font-weight: 700;">Narcotic Log Signature Missing</h4>
                                <p style="color: var(--text-muted); line-height: 1.6; font-style: italic; border-left: 3px solid #D1D5DB; padding-left: 12px; margin-bottom: 12px;">"Logbook on Dec 12 lacks pharmacist initial. Entry shows 'JD' but no licensed pharmacist signature per Section 56(1) Narcotic Control Regulations."</p>
                                
                                <!-- Rule Explanation -->
                                <div style="background: #FEF2F2; border: 1px solid #FECACA; border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                                    <div style="font-weight: 700; font-size: 0.85rem; margin-bottom: 6px; color: #991B1B;"><i class="fas fa-info-circle"></i> Why This Matters</div>
                                    <p style="font-size: 0.85rem; line-height: 1.6; color: var(--text-muted); margin-bottom: 8px;">Narcotic Control Regulations Section 56(1) requires that all narcotic transactions be recorded and signed by a licensed pharmacist. This is a federal law violation, not a guideline. Incomplete records can result in license suspension and potential criminal charges.</p>
                                    <div style="font-size: 0.8rem; color: #7F1D1D; font-weight: 600;">⚠️ Legal Consequence: Fines up to $5,000 per violation + possible license review</div>
                                </div>

                                <!-- Actionable Guidance -->
                                <div style="background: #F9FAFB; border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                                    <div style="font-weight: 700; font-size: 0.85rem; margin-bottom: 8px; color: var(--text-main);">🎯 Recommended Action</div>
                                    <div style="display: grid; gap: 8px;">
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #10B981; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">FIX</span>
                                            <span style="font-size: 0.85rem; color: var(--text-main);"><strong>Immediate:</strong> Identify pharmacist who made entry, have them sign retroactively with date correction note. Document in response letter with corrective action plan.</span>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #9CA3AF; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">NEGOTIATE</span>
                                            <span style="font-size: 0.85rem; color: #6B7280;"><strong>Not applicable:</strong> This is a legal requirement with no discretion. Cannot be negotiated.</span>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #EF4444; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">IGNORE</span>
                                            <span style="font-size: 0.85rem; color: #991B1B;"><strong>Risk: CRITICAL</strong> - Ignoring this will result in formal charges. Must be addressed before inspection closes.</span>
                                        </div>
                                    </div>
                                </div>

                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <span style="background: white; border: 1px solid #FECACA; color: #991B1B; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-gavel"></i> NCR Section 56(1)</span>
                                    <span style="background: white; border: 1px solid #E5E7EB; color: #6B7280; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-calendar"></i> Dec 12, 2025</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                            <button class="btn-primary" style="padding: 8px 16px; font-size: 0.85rem;" onclick="openModal('responseModal')"><i class="fas fa-pen"></i> Draft Response</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-check"></i> Mark Resolved</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-comment"></i> Add Note</button>
                        </div>
                    </div>

                    <!-- Issue 2 -->
                    <div style="background: white; border: 1px solid #FECACA; border-left: 4px solid #EF4444; border-radius: 12px; padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow-card);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <span style="background: #FEE2E2; color: #991B1B; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700;">Law - Critical</span>
                                    <span style="background: #F3F4F6; color: #4B5563; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 600;">Page 6, Para 1</span>
                                </div>
                                <h4 style="font-size: 1.1rem; margin-bottom: 8px; font-weight: 700;">Temperature Log Gap</h4>
                                <p style="color: var(--text-muted); line-height: 1.6; font-style: italic; border-left: 3px solid #D1D5DB; padding-left: 12px; margin-bottom: 12px;">"Missing evening temperature check for Jan 14. Fridge log shows only AM reading (4.2°C). Evening check required per Standard 3.4."</p>
                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <span style="background: white; border: 1px solid #FECACA; color: #991B1B; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-book"></i> Standard 3.4</span>
                                    <span style="background: white; border: 1px solid #E5E7EB; color: #6B7280; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-calendar"></i> Jan 14, 2026</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                            <button class="btn-primary" style="padding: 8px 16px; font-size: 0.85rem;" onclick="openModal('responseModal')"><i class="fas fa-pen"></i> Draft Response</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-check"></i> Mark Resolved</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-comment"></i> Add Note</button>
                        </div>
                    </div>

                    <!-- Issue 3 -->
                    <div style="background: white; border: 1px solid #FDE68A; border-left: 4px solid #F59E0B; border-radius: 12px; padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow-card);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <span style="background: #FEF9E7; color: #D97706; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700;">Guideline - Moderate</span>
                                    <span style="background: #F3F4F6; color: #4B5563; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 600;">Page 8, Para 3</span>
                                </div>
                                <h4 style="font-size: 1.1rem; margin-bottom: 8px; font-weight: 700;">Staff Training Record Outdated</h4>
                                <p style="color: var(--text-muted); line-height: 1.6; font-style: italic; border-left: 3px solid #D1D5DB; padding-left: 12px; margin-bottom: 12px;">"Technician M. Chen's last sterile compounding refresher was Sept 2024. Annual update recommended per NAPRA Guideline 15.2."</p>
                                
                                <!-- Rule Explanation -->
                                <div style="background: #FEF9E7; border: 1px solid #FDE68A; border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                                    <div style="font-weight: 700; font-size: 0.85rem; margin-bottom: 6px; color: #D97706;"><i class="fas fa-info-circle"></i> Why This Matters</div>
                                    <p style="font-size: 0.85rem; line-height: 1.6; color: var(--text-muted); margin-bottom: 8px;">NAPRA Model Standards recommend annual sterile compounding competency assessments. This is a <strong>professional standard</strong>, not a legal requirement. Provincial colleges may enforce differently—Alberta requires every 12 months, BC allows up to 18 months with documentation.</p>
                                    <div style="font-size: 0.8rem; color: #92400E; font-weight: 600;">⚠️ Compliance Note: Shows commitment to quality but not legally mandated</div>
                                </div>

                                <!-- Actionable Guidance -->
                                <div style="background: #F9FAFB; border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                                    <div style="font-weight: 700; font-size: 0.85rem; margin-bottom: 8px; color: var(--text-main);">🎯 Recommended Action</div>
                                    <div style="display: grid; gap: 8px;">
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #10B981; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">FIX</span>
                                            <span style="font-size: 0.85rem; color: var(--text-main);"><strong>Recommended:</strong> Schedule refresher within 30 days. Shows proactive compliance. Costs ~$200, takes 3 hours. Prevents escalation in future audits.</span>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #F59E0B; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">NEGOTIATE</span>
                                            <span style="font-size: 0.85rem; color: var(--text-main);"><strong>Option:</strong> Provide evidence of alternate training (webinars, self-study) completed in last 6 months. Request extension to Q2 2026 with interim documentation.</span>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #3B82F6; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">IGNORE</span>
                                            <span style="font-size: 0.85rem; color: #4B5563;"><strong>Risk: LOW-MEDIUM</strong> - Can be deferred if technician not actively compounding. May become "repeat finding" in next audit, potentially escalating severity.</span>
                                        </div>
                                    </div>
                                </div>

                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <span style="background: white; border: 1px solid #FDE68A; color: #D97706; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-book-open"></i> NAPRA 15.2</span>
                                    <span style="background: white; border: 1px solid #E5E7EB; color: #6B7280; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-user"></i> M. Chen</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                            <button class="btn-primary" style="background: #F59E0B; padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-calendar-plus"></i> Schedule Training</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-check"></i> Mark Resolved</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-comment"></i> Add Note</button>
                        </div>
                    </div>

                    <!-- Issue 4 - LAW -->
                    <div style="background: white; border: 1px solid #FECACA; border-left: 4px solid #EF4444; border-radius: 12px; padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow-card);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <span style="background: #FEE2E2; color: #991B1B; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700;">Law - Critical</span>
                                    <span style="background: #F3F4F6; color: #4B5563; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 600;">Page 10, Para 1</span>
                                </div>
                                <h4 style="font-size: 1.1rem; margin-bottom: 8px; font-weight: 700;">Prescription Record Incomplete</h4>
                                <p style="color: var(--text-muted); line-height: 1.6; font-style: italic; border-left: 3px solid #D1D5DB; padding-left: 12px; margin-bottom: 12px;">"Rx #2847 missing prescriber's phone number. All prescriptions must include complete prescriber contact information per Health Professions Act Section 21(3)."</p>
                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <span style="background: white; border: 1px solid #FECACA; color: #991B1B; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-gavel"></i> HPA Section 21(3)</span>
                                    <span style="background: white; border: 1px solid #E5E7EB; color: #6B7280; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-prescription"></i> Rx #2847</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                            <button class="btn-primary" style="padding: 8px 16px; font-size: 0.85rem;" onclick="openModal('responseModal')"><i class="fas fa-pen"></i> Draft Response</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-check"></i> Mark Resolved</button>
                        </div>
                    </div>

                    <!-- Issue 5 - GUIDELINE -->
                    <div style="background: white; border: 1px solid #FDE68A; border-left: 4px solid #F59E0B; border-radius: 12px; padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow-card);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <span style="background: #FEF9E7; color: #D97706; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700;">Guideline - Moderate</span>
                                    <span style="background: #F3F4F6; color: #4B5563; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 600;">Page 11, Para 4</span>
                                </div>
                                <h4 style="font-size: 1.1rem; margin-bottom: 8px; font-weight: 700;">Patient Counseling Documentation Gap</h4>
                                <p style="color: var(--text-muted); line-height: 1.6; font-style: italic; border-left: 3px solid #D1D5DB; padding-left: 12px; margin-bottom: 12px;">"New prescription dispensed without documented patient counseling. Guideline 8.1 recommends maintaining counseling logs for quality assurance purposes."</p>
                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <span style="background: white; border: 1px solid #FDE68A; color: #D97706; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-book-open"></i> Guideline 8.1</span>
                                    <span style="background: white; border: 1px solid #E5E7EB; color: #6B7280; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-calendar"></i> Jan 20, 2026</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                            <button class="btn-primary" style="background: #F59E0B; padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-clipboard-check"></i> Create Log Template</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-check"></i> Mark Resolved</button>
                        </div>
                    </div>

                    <!-- Issue 6 - BEST PRACTICE -->
                    <div style="background: white; border: 1px solid #BAE6FD; border-left: 4px solid #0EA5E9; border-radius: 12px; padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow-card);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <span style="background: #F0F9FF; color: #0369A1; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700;">Best Practice - Advisory</span>
                                    <span style="background: #F3F4F6; color: #4B5563; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 600;">Page 12, Para 2</span>
                                </div>
                                <h4 style="font-size: 1.1rem; margin-bottom: 8px; font-weight: 700;">Fridge Placement Not Optimal</h4>
                                <p style="color: var(--text-muted); line-height: 1.6; font-style: italic; border-left: 3px solid #D1D5DB; padding-left: 12px; margin-bottom: 12px;">"Refrigerator located near window with direct sunlight exposure. Industry best practice suggests placement away from heat sources to maintain temperature stability."</p>
                                
                                <!-- Rule Explanation -->
                                <div style="background: #F0F9FF; border: 1px solid #BAE6FD; border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                                    <div style="font-weight: 700; font-size: 0.85rem; margin-bottom: 6px; color: #0369A1;"><i class="fas fa-info-circle"></i> Why This Matters</div>
                                    <p style="font-size: 0.85rem; line-height: 1.6; color: var(--text-muted); margin-bottom: 8px;">This is an <strong>optimization suggestion</strong>, not a regulatory requirement. USP 797 requires maintaining 2-8°C but doesn't specify location. Sunlight exposure increases compressor workload, raising energy costs and wear. No compliance risk, purely operational efficiency.</p>
                                    <div style="font-size: 0.8rem; color: #0369A1; font-weight: 600;">💡 Potential Benefit: ~15% energy savings, extended equipment life (8-10 years vs 5-6 years)</div>
                                </div>

                                <!-- Actionable Guidance -->
                                <div style="background: #F9FAFB; border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                                    <div style="font-weight: 700; font-size: 0.85rem; margin-bottom: 8px; color: var(--text-main);">🎯 Recommended Action</div>
                                    <div style="display: grid; gap: 8px;">
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #10B981; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">FIX</span>
                                            <span style="font-size: 0.85rem; color: var(--text-main);"><strong>Optional:</strong> Relocate during next renovation cycle. Install UV-blocking window film as interim solution (~$150). Monitor temperature logs for fluctuations indicating stress.</span>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #0EA5E9; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">NEGOTIATE</span>
                                            <span style="font-size: 0.85rem; color: var(--text-main);"><strong>Explain:</strong> If fridge maintains stable temps per current logs, acknowledge observation but note: "Unit operating within spec. Will reassess during equipment lifecycle planning."</span>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: start;">
                                            <span style="background: #10B981; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; white-space: nowrap;">IGNORE</span>
                                            <span style="font-size: 0.85rem; color: #10B981;"><strong>Risk: NONE</strong> - Perfectly acceptable to ignore. This is a helpful tip, not a compliance issue. No follow-up required.</span>
                                        </div>
                                    </div>
                                </div>

                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <span style="background: white; border: 1px solid #BAE6FD; color: #0369A1; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-lightbulb"></i> Industry Standard</span>
                                    <span style="background: white; border: 1px solid #E5E7EB; color: #6B7280; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-temperature-low"></i> Storage</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                            <button class="btn-primary" style="background: #0EA5E9; padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-wrench"></i> Request Assessment</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-times"></i> Dismiss</button>
                        </div>
                    </div>

                    <!-- Issue 7 - GUIDELINE -->
                    <div style="background: white; border: 1px solid #FDE68A; border-left: 4px solid #F59E0B; border-radius: 12px; padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow-card);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <span style="background: #FEF9E7; color: #D97706; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700;">Guideline - Moderate</span>
                                    <span style="background: #F3F4F6; color: #4B5563; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 600;">Page 13, Para 1</span>
                                </div>
                                <h4 style="font-size: 1.1rem; margin-bottom: 8px; font-weight: 700;">Pharmacy Layout Privacy Concern</h4>
                                <p style="color: var(--text-muted); line-height: 1.6; font-style: italic; border-left: 3px solid #D1D5DB; padding-left: 12px; margin-bottom: 12px;">"Counseling area lacks visual privacy barrier. NAPRA Model Standards 6.3 recommend semi-private consultation space for sensitive health discussions."</p>
                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <span style="background: white; border: 1px solid #FDE68A; color: #D97706; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-book-open"></i> Model Standards 6.3</span>
                                    <span style="background: white; border: 1px solid #E5E7EB; color: #6B7280; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-shield-alt"></i> Privacy</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                            <button class="btn-primary" style="background: #F59E0B; padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-store"></i> Layout Solutions</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-check"></i> Mark Resolved</button>
                        </div>
                    </div>

                    <!-- Issue 8 - BEST PRACTICE -->
                    <div style="background: white; border: 1px solid #BAE6FD; border-left: 4px solid #0EA5E9; border-radius: 12px; padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow-card);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <span style="background: #F0F9FF; color: #0369A1; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700;">Best Practice - Advisory</span>
                                    <span style="background: #F3F4F6; color: #4B5563; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 600;">Page 14, Para 3</span>
                                </div>
                                <h4 style="font-size: 1.1rem; margin-bottom: 8px; font-weight: 700;">Digital Backup System Recommended</h4>
                                <p style="color: var(--text-muted); line-height: 1.6; font-style: italic; border-left: 3px solid #D1D5DB; padding-left: 12px; margin-bottom: 12px;">"Manual log system in use. While compliant, professional associations recommend cloud-based backup systems for improved disaster recovery and audit efficiency."</p>
                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <span style="background: white; border: 1px solid #BAE6FD; color: #0369A1; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-lightbulb"></i> Professional Recommendation</span>
                                    <span style="background: white; border: 1px solid #E5E7EB; color: #6B7280; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-cloud"></i> Technology</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                            <button class="btn-primary" style="background: #0EA5E9; padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-info-circle"></i> Learn More</button>
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle); padding: 8px 16px; font-size: 0.85rem;"><i class="fas fa-times"></i> Not Interested</button>
                        </div>
                    </div>
                </div>

                <!-- AI Insights Section -->
                <div style="background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%); border: 2px solid #BAE6FD; border-radius: var(--radius-lg); padding: 32px; margin-bottom: 32px;">
                    <div style="display: flex; gap: 16px;">
                        <div style="width: 56px; height: 56px; background: #0EA5E9; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; flex-shrink: 0; font-size: 1.5rem;">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div>
                            <h3 style="font-size: 1.2rem; margin-bottom: 16px;">AI Insights & Recommendations</h3>
                            <ul style="list-style: none; padding: 0; margin: 0; line-height: 1.8;">
                                <li style="margin-bottom: 12px;"><i class="fas fa-gavel" style="color: #EF4444; margin-right: 8px;"></i> <strong>3 Critical Laws Detected:</strong> Narcotic documentation, temperature monitoring, and prescription record compliance require immediate action.</li>
                                <li style="margin-bottom: 12px;"><i class="fas fa-book-open" style="color: #F59E0B; margin-right: 8px;"></i> <strong>3 Guidelines Flagged:</strong> Staff training, patient counseling documentation, and privacy considerations should be addressed within 30 days.</li>
                                <li style="margin-bottom: 12px;"><i class="fas fa-lightbulb" style="color: #0EA5E9; margin-right: 8px;"></i> <strong>2 Best Practices Suggested:</strong> Fridge placement optimization and digital backup system can enhance operational efficiency.</li>
                                <li style="margin-bottom: 12px;"><i class="fas fa-chart-line" style="color: #10B981; margin-right: 8px;"></i> <strong>Priority Breakdown:</strong> Focus on 3 critical law violations first (legal requirement), then address guidelines (professional standards), finally consider best practices (optimization).</li>
                                <li><i class="fas fa-clock" style="color: #0EA5E9; margin-right: 8px;"></i> <strong>Estimated Resolution Time:</strong> Critical items: 2-3 days | Guidelines: 2-4 weeks | Best practices: Optional implementation timeline.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-settings" class="view-section">
            <div style="max-width: 1200px; margin: 0 auto; padding: 40px; width: 100%;">
                <div class="studio-header">
                     <h2>Settings & Configuration</h2>
                     <p>Manage your pharmacy profile, notifications, and AI preferences.</p>
                </div>

                <div style="display: grid; grid-template-columns: 240px 1fr; gap: 40px;">
                    <!-- Settings Nav -->
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <div class="chip" style="justify-content: flex-start; background: var(--primary-light); color: var(--primary); border: none;"><i class="fas fa-user"></i> Profile</div>
                        <div class="chip" style="justify-content: flex-start; border: none; background: transparent;"><i class="fas fa-bell"></i> Notifications</div>
                        <div class="chip" style="justify-content: flex-start; border: none; background: transparent;"><i class="fas fa-robot"></i> AI tuning</div>
                        <div class="chip" style="justify-content: flex-start; border: none; background: transparent;"><i class="fas fa-lock"></i> Security</div>
                    </div>

                    <!-- Settings Content -->
                    <div style="background: white; border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 32px;">
                        <h3 style="margin-bottom: 24px;">Pharmacy Profile</h3>
                        
                        <div class="detail-row" style="margin-top: 0;">
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">Pharmacy License #</div>
                                <div style="color: var(--text-muted); font-size: 0.85rem;">Used for regulatory lookups</div>
                            </div>
                            <input type="text" value="PH-2024-8892" style="padding: 8px 12px; border: 1px solid var(--border-subtle); border-radius: 6px;">
                        </div>

                        <div class="detail-row">
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">Auto-Monitor Netcare</div>
                                <div style="color: var(--text-muted); font-size: 0.85rem;">Automatically check for opioid duplication</div>
                            </div>
                            <div class="toggle-switch active" onclick="this.classList.toggle('active')"></div>
                        </div>

                        <div class="detail-row">
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">Daily Briefing Email</div>
                                <div style="color: var(--text-muted); font-size: 0.85rem;">Receive summary of new alerts at 8:00 AM</div>
                            </div>
                            <div class="toggle-switch active" onclick="this.classList.toggle('active')"></div>
                        </div>

                        <div class="detail-row" style="border: none;">
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">Data Retention</div>
                                <div style="color: var(--text-muted); font-size: 0.85rem;">Inspector logs kept for 10 years</div>
                            </div>
                           <div class="toggle-switch" onclick="this.classList.toggle('active')"></div>
                        </div>

                        <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid var(--border-subtle); display: flex; justify-content: flex-end; gap: 12px;">
                            <button class="btn-primary" style="background: white; color: var(--text-main); border: 1px solid var(--border-subtle);">Cancel</button>
                            <button class="btn-primary" id="saveSettingsBtn" onclick="saveSettings()">Save Changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <div class="toast-container" id="toastContainer"></div>

    <div class="modal-overlay" id="toolWizardModal">
        <div class="modal-box" style="width: 800px; max-width: 95%;">
            <i class="fas fa-times modal-close" onclick="closeModal('toolWizardModal')"></i>
            <div id="toolWizardContent"></div>
        </div>
    </div>

    <div class="modal-overlay" id="genModal">
        <div class="modal-box" id="genContent">
            </div>
    </div>

    <div class="modal-overlay" id="feedModal">
        <div class="modal-box">
            <i class="fas fa-times modal-close" onclick="closeModal('feedModal')"></i>
            <h2 style="margin-bottom: 24px;"><i class="fas fa-rss" style="color: var(--primary);"></i> College Updates</h2>
            
            <div class="feed-item">
                <span class="feed-tag tag-law">New Law - Critical</span>
                <div style="font-weight: 700; margin-bottom: 4px;">Opioid Verification Standards</div>
                <div style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 8px;">Effective March 1st. All pharmacists must check Netcare before dispensing any opioid agonist therapy. Failure to document this check constitutes professional misconduct.</div>
                <button class="btn-primary" style="padding: 6px 12px; font-size: 0.8rem;">Read Regulation</button>
            </div>
            
            <div class="feed-item">
                <span class="feed-tag tag-news">News</span>
                <div style="font-weight: 700; margin-bottom: 4px;">License Renewal Window Open</div>
                <div style="color: var(--text-muted); font-size: 0.9rem;">Renewal window opens in 14 days. Ensure all Continuing Education Units (CEUs) are logged in your profile before starting the application.</div>
            </div>

            <div class="feed-item">
                <span class="feed-tag tag-law" style="background: #DBEAFE; color: #1E40AF;">Guideline Update</span>
                <div style="font-weight: 700; margin-bottom: 4px;">Symptomatic Prescribing (Minor Ailments)</div>
                <div style="color: var(--text-muted); font-size: 0.9rem;">New algorithms released for UTI and Cold Sore prescribing. Review standard 12.4.</div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="inspectorModal">
        <div class="modal-box">
            <i class="fas fa-times modal-close" onclick="closeModal('inspectorModal')"></i>
            <div style="display: flex; gap: 16px; align-items: center; margin-bottom: 24px;">
                <div style="width: 60px; height: 60px; background: #E0F2F1; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 1.5rem; font-weight:700;">JS</div>
                <div>
                    <h2 style="margin: 0;">Inspector J. Smith</h2>
                    <p style="color: var(--text-muted);">Lead Inspector • Region: Calgary North</p>
                </div>
            </div>

            <div style="background: #F9FAFB; padding: 20px; border-radius: 12px; margin-bottom: 24px;">
                <h4 style="margin-bottom: 16px;">Historical Focus Areas (Last 20 Audits)</h4>
                
                <div style="margin-bottom: 12px;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.9rem; margin-bottom: 4px;">
                        <span>Narcotic Reconciliation Logs</span>
                        <span style="font-weight: 700;">85% Frequency</span>
                    </div>
                    <div class="progress-container"><div class="progress-fill" style="width: 85%; background: #EF4444;"></div></div>
                </div>

                <div style="margin-bottom: 12px;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.9rem; margin-bottom: 4px;">
                        <span>Sterile Compounding Surfaces</span>
                        <span style="font-weight: 700;">70% Frequency</span>
                    </div>
                    <div class="progress-container"><div class="progress-fill" style="width: 70%; background: #F59E0B;"></div></div>
                </div>

                <div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.9rem; margin-bottom: 4px;">
                        <span>Staff Training Records</span>
                        <span style="font-weight: 700;">45% Frequency</span>
                    </div>
                    <div class="progress-container"><div class="progress-fill" style="width: 45%; background: #10B981;"></div></div>
                </div>
            </div>

            <button class="btn-primary" style="width: 100%;">Download Prep Checklist</button>
        </div>
    </div>

    <div class="modal-overlay" id="monitoringModal">
        <div class="modal-box" style="width: 900px; max-width: 95%;">
            <i class="fas fa-times modal-close" onclick="closeModal('monitoringModal')"></i>
            
            <!-- Header -->
            <div style="border-bottom: 2px solid var(--border-subtle); padding-bottom: 20px; margin-bottom: 24px;">
                <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
                    <div style="width: 48px; height: 48px; background: var(--primary-light); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-file-contract" style="color: var(--primary); font-size: 1.3rem;"></i>
                    </div>
                    <div style="flex: 1;">
                        <h2 style="margin: 0 0 4px 0;">AI Report Classification</h2>
                        <div style="font-size: 0.9rem; color: var(--text-muted);">Inspection_Feb05.pdf • Uploaded & Processed Feb 5, 2026</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 4px;">AI Confidence</div>
                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--accent-green);">94%</div>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                    <div style="background: #FEF2F2; padding: 12px; border-radius: 8px; border: 1px solid #FECACA; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 800; color: #991B1B;">3</div>
                        <div style="font-size: 0.75rem; color: #7F1D1D; font-weight: 600;">Total Findings</div>
                    </div>
                    <div style="background: #FEE2E2; padding: 12px; border-radius: 8px; border: 1px solid #FECACA; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 800; color: #DC2626;">2</div>
                        <div style="font-size: 0.75rem; color: #991B1B; font-weight: 600;">Critical</div>
                    </div>
                    <div style="background: #FEF9E7; padding: 12px; border-radius: 8px; border: 1px solid #FDE68A; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 800; color: #D97706;">1</div>
                        <div style="font-size: 0.75rem; color: #92400E; font-weight: 600;">Moderate</div>
                    </div>
                    <div style="background: #F0FDF4; padding: 12px; border-radius: 8px; border: 1px solid #BBF7D0; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 800; color: #166534;">70%</div>
                        <div style="font-size: 0.75rem; color: #14532D; font-weight: 600;">Compliance</div>
                    </div>
                </div>
            </div>

            <!-- Findings List -->
            <div style="margin-bottom: 24px;">
                <h3 style="font-size: 1.05rem; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-exclamation-circle" style="color: #EF4444;"></i> Detected Issues
                </h3>

                <!-- Issue 1 -->
                <div style="background: white; border: 1px solid #FECACA; border-left: 4px solid #EF4444; border-radius: 8px; padding: 16px; margin-bottom: 12px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                        <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                                <span class="feed-tag tag-law">Law - Critical</span>
                                <span style="font-size: 0.75rem; color: var(--text-muted);">Page 4, Para 2</span>
                            </div>
                            <div style="font-weight: 700; font-size: 1.05rem; margin-bottom: 6px; color: var(--text-main);">Narcotic Log Signature Missing</div>
                            <div style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 10px;">"Logbook on Dec 12 lacks pharmacist initial. Entry shows 'JD' but no licensed pharmacist signature per Section 56(1) Narcotic Control Regulations."</div>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                <span style="font-size: 0.75rem; padding: 4px 8px; background: #F3F4F6; border-radius: 4px; color: var(--text-muted);"><i class="fas fa-scale-balanced" style="margin-right: 4px;"></i>NCR Section 56(1)</span>
                                <span style="font-size: 0.75rem; padding: 4px 8px; background: #F3F4F6; border-radius: 4px; color: var(--text-muted);"><i class="fas fa-calendar" style="margin-right: 4px;"></i>Dec 12, 2025</span>
                            </div>
                        </div>
                        <button class="btn-primary" style="padding: 6px 14px; font-size: 0.8rem; white-space: nowrap;" onclick="openModal('responseModal'); closeModal('monitoringModal');">Draft Response</button>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                        <button style="font-size: 0.8rem; padding: 6px 12px; background: #F3F4F6; border: none; border-radius: 6px; cursor: pointer; color: var(--text-main);">
                            <i class="fas fa-check-circle" style="margin-right: 4px; color: var(--accent-green);"></i>Mark Resolved
                        </button>
                        <button style="font-size: 0.8rem; padding: 6px 12px; background: #F3F4F6; border: none; border-radius: 6px; cursor: pointer; color: var(--text-main);">
                            <i class="fas fa-comment" style="margin-right: 4px; color: var(--primary);"></i>Add Note
                        </button>
                    </div>
                </div>

                <!-- Issue 2 -->
                <div style="background: white; border: 1px solid #FECACA; border-left: 4px solid #EF4444; border-radius: 8px; padding: 16px; margin-bottom: 12px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                        <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                                <span class="feed-tag tag-law">Law - Critical</span>
                                <span style="font-size: 0.75rem; color: var(--text-muted);">Page 6, Para 1</span>
                            </div>
                            <div style="font-weight: 700; font-size: 1.05rem; margin-bottom: 6px; color: var(--text-main);">Temperature Log Gap</div>
                            <div style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 10px;">"Missing evening temperature check for Jan 14. Fridge log shows only AM reading (4.2°C). Evening check required per Standard 3.4."</div>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                <span style="font-size: 0.75rem; padding: 4px 8px; background: #F3F4F6; border-radius: 4px; color: var(--text-muted);"><i class="fas fa-book" style="margin-right: 4px;"></i>Standard 3.4</span>
                                <span style="font-size: 0.75rem; padding: 4px 8px; background: #F3F4F6; border-radius: 4px; color: var(--text-muted);"><i class="fas fa-calendar" style="margin-right: 4px;"></i>Jan 14, 2026</span>
                            </div>
                        </div>
                        <button class="btn-primary" style="padding: 6px 14px; font-size: 0.8rem; white-space: nowrap;" onclick="openModal('responseModal'); closeModal('monitoringModal');">Draft Response</button>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                        <button style="font-size: 0.8rem; padding: 6px 12px; background: #F3F4F6; border: none; border-radius: 6px; cursor: pointer; color: var(--text-main);">
                            <i class="fas fa-check-circle" style="margin-right: 4px; color: var(--accent-green);"></i>Mark Resolved
                        </button>
                        <button style="font-size: 0.8rem; padding: 6px 12px; background: #F3F4F6; border: none; border-radius: 6px; cursor: pointer; color: var(--text-main);">
                            <i class="fas fa-comment" style="margin-right: 4px; color: var(--primary);"></i>Add Note
                        </button>
                    </div>
                </div>

                <!-- Issue 3 -->
                <div style="background: white; border: 1px solid #FDE68A; border-left: 4px solid #F59E0B; border-radius: 8px; padding: 16px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                        <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                                <span class="feed-tag tag-guideline">Guideline - Moderate</span>
                                <span style="font-size: 0.75rem; color: var(--text-muted);">Page 8, Para 3</span>
                            </div>
                            <div style="font-weight: 700; font-size: 1.05rem; margin-bottom: 6px; color: var(--text-main);">Staff Training Record Outdated</div>
                            <div style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 10px;">"Technician M. Chen's last sterile compounding refresher was Sept 2024. Annual update recommended per NAPRA Guideline 15.2."</div>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                <span style="font-size: 0.75rem; padding: 4px 8px; background: #F3F4F6; border-radius: 4px; color: var(--text-muted);"><i class="fas fa-book-open" style="margin-right: 4px;"></i>NAPRA 15.2</span>
                                <span style="font-size: 0.75rem; padding: 4px 8px; background: #F3F4F6; border-radius: 4px; color: var(--text-muted);"><i class="fas fa-user" style="margin-right: 4px;"></i>M. Chen</span>
                            </div>
                        </div>
                        <button class="btn-primary" style="padding: 6px 14px; font-size: 0.8rem; white-space: nowrap; background: #F59E0B;">Schedule Training</button>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-subtle); display: flex; gap: 12px;">
                        <button style="font-size: 0.8rem; padding: 6px 12px; background: #F3F4F6; border: none; border-radius: 6px; cursor: pointer; color: var(--text-main);">
                            <i class="fas fa-check-circle" style="margin-right: 4px; color: var(--accent-green);"></i>Mark Resolved
                        </button>
                        <button style="font-size: 0.8rem; padding: 6px 12px; background: #F3F4F6; border: none; border-radius: 6px; cursor: pointer; color: var(--text-main);">
                            <i class="fas fa-comment" style="margin-right: 4px; color: var(--primary);"></i>Add Note
                        </button>
                    </div>
                </div>
            </div>

            <!-- AI Insights -->
            <div style="background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%); border: 1px solid #BAE6FD; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                <div style="display: flex; gap: 12px;">
                    <div style="width: 40px; height: 40px; background: #0EA5E9; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; flex-shrink: 0;">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div>
                        <h4 style="margin: 0 0 8px 0; font-size: 1rem;">AI Analysis & Recommendations</h4>
                        <ul style="margin: 0; padding-left: 20px; font-size: 0.9rem; color: #0C4A6E; line-height: 1.8;">
                            <li><strong>Pattern Detection:</strong> Narcotic documentation issues appear 3x in past year. Consider implementing dual-check system.</li>
                            <li><strong>Risk Assessment:</strong> Temperature gaps could lead to product integrity concerns. Recommend digital monitoring solution.</li>
                            <li><strong>Compliance Trend:</strong> Your score improved from 65% (last audit) to 70%. On track for 80%+ with these fixes.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Document Info -->
            <div style="background: #F9FAFB; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                <h4 style="margin: 0 0 12px 0; font-size: 0.95rem;">Document Details</h4>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; font-size: 0.85rem;">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">File Name:</span>
                        <span style="font-weight: 600;">Inspection_Feb05.pdf</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">Pages Analyzed:</span>
                        <span style="font-weight: 600;">12 pages</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">Upload Date:</span>
                        <span style="font-weight: 600;">Feb 5, 2026</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">Processing Time:</span>
                        <span style="font-weight: 600;">2.3 seconds</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">Regulations Checked:</span>
                        <span style="font-weight: 600;">47 standards</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">Last Updated:</span>
                        <span style="font-weight: 600;">2 hours ago</span>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div style="display: flex; gap: 12px;">
                <button class="btn-primary" style="flex: 1; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <i class="fas fa-file-pdf"></i> View Original PDF
                </button>
                <button class="btn-primary" style="flex: 1; background: white; color: var(--primary); border: 2px solid var(--primary); display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <i class="fas fa-download"></i> Export Report
                </button>
                <button class="btn-primary" style="flex: 1; background: var(--accent-green); display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <i class="fas fa-wand-magic-sparkles"></i> Generate All Responses
                </button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="responseModal">
        <div class="modal-box">
            <i class="fas fa-times modal-close" onclick="closeModal('responseModal')"></i>
            <h2 style="margin-bottom: 8px;">Response Generator</h2>
            <p style="color: var(--text-muted); margin-bottom: 24px;">AI will draft a formal letter citing specific regulations.</p>

            <label style="font-weight: 600; display: block; margin-bottom: 8px;">Select Tone Strategy:</label>
            <div class="tone-selector">
                <div class="tone-option selected" onclick="selectTone(this)">
                    <i class="fas fa-check-circle"></i><br>Standard
                </div>
                <div class="tone-option" onclick="selectTone(this)">
                    <i class="fas fa-handshake"></i><br>Conciliatory
                </div>
                <div class="tone-option" onclick="selectTone(this)">
                    <i class="fas fa-gavel"></i><br>Dispute
                </div>
            </div>

            <label style="font-weight: 600; display: block; margin-bottom: 8px; margin-top: 24px;">Select Response Format:</label>
            <div class="tone-selector">
                <div class="tone-option selected" onclick="selectTone(this)">
                    <i class="fas fa-file-lines"></i><br>Formal Letter
                </div>
                <div class="tone-option" onclick="selectTone(this)">
                    <i class="fas fa-envelope"></i><br>Email
                </div>
                <div class="tone-option" onclick="selectTone(this)">
                    <i class="fas fa-list-ol"></i><br>Point-by-Point
                </div>
            </div>

            <label style="font-weight: 600; display: block; margin-bottom: 8px;">Paste Inspector Finding:</label>
            <textarea style="width: 100%; padding: 12px; border: 1px solid var(--border-subtle); border-radius: 12px; min-height: 100px; font-family: inherit; margin-bottom: 24px;" placeholder="e.g. Narcotic count was not signed on Dec 12..."></textarea>

            <button class="btn-primary" style="width: 100%;">Generate Draft</button>
        </div>
    </div>

    <div class="modal-overlay" id="toolWizardModal">
        <div class="modal-box" style="width: 800px; max-width: 95%;">
            <i class="fas fa-times modal-close" onclick="closeModal('toolWizardModal')"></i>
            <div id="toolWizardContent"></div>
        </div>
    </div>

    <div class="modal-overlay" id="uploadModal">
        <div class="modal-box" style="width: 700px; max-width: 95%;">
            <i class="fas fa-times modal-close" onclick="closeModal('uploadModal')"></i>
            <h2 style="margin-bottom: 8px;">Upload Sources</h2>
            <p style="color: var(--text-muted); margin-bottom: 24px; font-size: 0.95rem;">Add documents, videos, audio, or web links to provide context for AI generation</p>
            
            <div class="file-drop-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
                <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--primary); margin-bottom: 16px; display: block;"></i>
                <div style="font-weight: 700; font-size: 1.1rem; margin-bottom: 8px;">Drop files here or click to browse</div>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 16px;">Supports PDF, DOCX, MP4, MP3, TXT and more</div>
                <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.txt,.mp4,.mp3,.wav" style="display: none;" onchange="handleFileSelect(event)">
            </div>
            
            <div id="uploadPreview" style="margin-top: 24px; display: none;">
                <h4 style="font-size: 0.95rem; font-weight: 700; margin-bottom: 12px; color: var(--text-muted);">FILES TO UPLOAD</h4>
                <div id="filesList" style="max-height: 200px; overflow-y: auto;"></div>
                <button class="btn-primary" style="width: 100%; margin-top: 16px;" onclick="uploadFiles()">
                    <i class="fas fa-upload"></i> Upload <span id="fileCount">0</span> File(s)
                </button>
            </div>
            
            <div style="margin-top: 24px; padding-top: 20px; border-top: 1px solid var(--border-subtle);">
                <h4 style="font-size: 0.9rem; font-weight: 700; margin-bottom: 12px;">Quick Add from Templates</h4>
                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                    <button class="chip" onclick="addSampleFile('ACP Guidelines 2026', 'pdf')" style="cursor: pointer;">
                        <i class="fas fa-file-pdf"></i> ACP Guidelines 2026
                    </button>
                    <button class="chip" onclick="addSampleFile('Opioid Standard 18.2', 'pdf')" style="cursor: pointer;">
                        <i class="fas fa-file-pdf"></i> Opioid Standard 18.2
                    </button>
                    <button class="chip" onclick="addSampleFile('NAPRA Model Standards', 'pdf')" style="cursor: pointer;">
                        <i class="fas fa-file-pdf"></i> NAPRA Model Standards
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="sopModal">
        <div class="modal-box">
            <i class="fas fa-times modal-close" onclick="closeModal('sopModal')"></i>
            <h2 style="margin-bottom: 24px;">SOP Generator Wizard</h2>

            <div class="wizard-step active" id="step1">
                <label style="font-weight: 600; display: block; margin-bottom: 12px;">1. What are we creating?</label>
                <select id="sopType" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 24px;">
                    <option>Standard Operating Procedure (SOP)</option>
                    <option>Incident Report</option>
                    <option>Loss Report</option>
                </select>
                
                <label style="font-weight: 600; display: block; margin-bottom: 12px;">2. Procedure Title</label>
                <input type="text" id="sopTitle" placeholder="e.g. Cold Chain Maintenance" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 24px;">
                
                <label style="font-weight: 600; display: block; margin-bottom: 12px;">3. Key Roles</label>
                <input type="text" id="sopRoles" placeholder="e.g. Pharmacy Manager, Technician" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 24px;">
                
                <button class="btn-primary" style="width: 100%;" onclick="startGeneration('Standard Operating Procedure', 'checklist')">Generate SOP</button>
            </div>
        </div>
    </div>

    <script>
        // === MOCK DATA FOR SEARCH ===
        const knowledgeBase = [
            { question: "fridge temperature", answer: "Required range is 2°C to 8°C. Consult Health Canada GUI-0001." },
            { question: "opioid", answer: "New Opioid guidelines require Netcare check before dispensing. Effective March 1st." },
            { question: "license", answer: "License renewal window opens 45 days before expiry. Ensure CEUs are logged." },
            { question: "destruction", answer: "Narcotic destruction requires two healthcare professionals to witness and sign." },
            { question: "counseling", answer: "Patient counseling is mandatory for all new prescriptions and dialogue is required for refills." }
        ];

        // === INITIALIZATION ===
        document.addEventListener('DOMContentLoaded', () => {
             updateGreeting();
             
             // Attach listeners to modal generate buttons
             document.querySelector('#sopModal .btn-primary:last-child').setAttribute('onclick', "startGeneration('Standard Operating Procedure', 'checklist')");
             document.querySelector('#responseModal .btn-primary').setAttribute('onclick', "startGeneration('Draft Response', 'form')");
        });

        function updateGreeting() {
            const hour = new Date().getHours();
            let greeting = "Welcome back";
            if (hour < 12) greeting = "Good Morning";
            else if (hour < 18) greeting = "Hi";
            else greeting = "Good Evening";
            
            const subtitle = document.querySelector('.hero-subtitle');
            if(subtitle) subtitle.innerHTML = `${greeting}, Dr. Peter. What would you like to solve today?`;
        }

        // === NAVIGATION ===
        function switchView(viewName, el) {
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.getElementById('view-' + viewName)?.classList.add('active');
            if(el) {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                el.classList.add('active');
            }
        }

        // === SEARCH LOGIC ===
        function handleHomePrompt(e) {
            if (e.key === 'Enter') {
                const query = e.target.value;
                if(query) {
                    showToast("Analyzing query...", "info");
                    setTimeout(() => {
                        switchView('search', document.querySelectorAll('.nav-item')[2]);
                        const searchInput = document.getElementById('searchInput');
                        searchInput.value = query;
                        performSearch();
                    }, 1000);
                }
            }
        }

        function handleSearch(e) {
            if (e.key === 'Enter') performSearch();
        }

        function performSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const resultsContainer = document.getElementById('searchResults');
            
            if (!query) return;

            // Simple search logic
            const match = knowledgeBase.find(item => query.includes(item.question) || item.answer.toLowerCase().includes(query));
            
            let html = '';
            if (match) {
                html = `
                    <div class="result-card" style="animation: slideUp 0.3s ease-out;">
                        <h3 style="margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-robot" style="color: var(--primary);"></i> AI Insight
                        </h3>
                        <p style="line-height: 1.6; color: var(--text-main); font-size: 1.1rem;">
                            ${match.answer}
                        </p>
                        <div style="margin-top: 16px; display: flex; gap: 8px;">
                            <span class="source-pill">Verified Source</span>
                            <span class="source-pill">Updated 2 days ago</span>
                        </div>
                    </div>
                `;
            } else {
                html = `
                    <div style="text-align: center; color: var(--text-muted); margin-top: 40px; animation: fadeIn 0.5s;">
                         <p>Analyzing 15,000 documents...</p>
                         <p>No direct match found. Try asking about "fridge temperature" or "opioid".</p>
                    </div>
                `;
            }

            resultsContainer.innerHTML = html;
        }

        // === GENERATION LOGIC ===
        function startGeneration(title, type) {
            closeModal('sopModal');
            closeModal('responseModal');
            
            const modal = document.getElementById('genModal');
            const content = document.getElementById('genContent');
            
            modal.classList.add('open');
            
            // 1. Show Loading State
            content.innerHTML = `
                <div class="gen-loader">
                    <div class="gen-spinner"><i class="fas fa-circle-notch"></i></div>
                    <h2 style="margin-bottom: 8px;">Generating ${title}...</h2>
                    <div class="gen-steps">
                        <div class="gen-step" id="step1"><i class="fas fa-check-circle"></i> Analyzing Regulations...</div>
                        <div class="gen-step" id="step2"><i class="fas fa-check-circle"></i> Synthesizing Content...</div>
                        <div class="gen-step" id="step3"><i class="fas fa-check-circle"></i> Finalizing Layout...</div>
                    </div>
                </div>
            `;

            // 2. Simulate Steps (Fast for demo)
            setTimeout(() => document.getElementById('step1').classList.add('active'), 300);
            setTimeout(() => { document.getElementById('step1').classList.add('done'); document.getElementById('step2').classList.add('active'); }, 1000);
            setTimeout(() => { document.getElementById('step2').classList.add('done'); document.getElementById('step3').classList.add('active'); }, 2000);
            
            // 3. Show Result (after 3s)
            setTimeout(() => {
                showResult(title, type);
                showToast(`${title} generated successfully!`);
            }, 3000);
        }

        // Global State for Interactive Demos
        let currentSlide = 1;
        const totalSlides = 5;
        const slideContent = [
            { title: "Audit Risks 2026", sub: "Top 3 Focus Areas for Pharmacy Teams" },
            { title: "1. Narcotic Reconciliation", sub: "Ensure all counts are signed daily by 2 staff." },
            { title: "2. Temperature Logs", sub: "Digital logs must be backed up weekly." },
            { title: "3. Sterile Compounding", sub: "New NAPRA standards effective July 1st." },
            { title: "Action Plan", sub: "Download the attached checklist." }
        ];

        function showResult(title, type) {
            const content = document.getElementById('genContent');
            let resultHTML = '';

            if (type === 'audio') {
                // Generate 20 random heights for waveform bars
                let bars = '';
                for(let i=0; i<20; i++) {
                    const h = Math.floor(Math.random() * 80 + 20);
                    const d = (Math.random() * 0.5).toFixed(2); // Random delay
                    bars += `<div class="waveform-bar" style="height: ${h}%; animation-delay: ${d}s;"></div>`;
                }

                resultHTML = `
                    <h2 style="margin-bottom:10px;">${title} Ready</h2>
                    <p style="color:var(--text-muted); margin-bottom:20px;">Podcast summary of Opioid Verification (5m 12s).</p>
                    <div class="preview-box">
                        <div class="audio-player" id="audioPlayer" style="height: 60px; gap: 8px; align-items: center;">
                            <div class="play-btn" onclick="toggleAudio(this)"><i class="fas fa-play"></i></div>
                            <div style="flex:1; height: 30px; display: flex; align-items: center; gap: 2px;">
                                ${bars}
                            </div>
                            <div style="font-size:0.8rem; font-weight:600; color:var(--text-muted); width: 80px; text-align: right;">00:00</div>
                        </div>
                    </div>
                `;
            } else if (type === 'quiz') {
                resultHTML = `
                    <h2 style="margin-bottom:10px;">Staff Quiz Ready</h2>
                    <p style="color:var(--text-muted); margin-bottom:20px;">Test your knowledge on the new SOP.</p>
                    <div class="preview-box" style="background:white; border:1px solid #e5e7eb;">
                        <div class="quiz-question">1. When must the Netcare check be performed?</div>
                        
                        <div class="quiz-option" onclick="runQuiz(this, false)">
                            A) At drop-off
                        </div>
                        <div class="quiz-option" onclick="runQuiz(this, true)">
                            B) Before final sign-off (dispensing)
                        </div>
                        <div class="quiz-option" onclick="runQuiz(this, false)">
                            C) Only for new patients
                        </div>
                        
                        <div id="quizFeedback" style="margin-top: 16px; font-weight: 600; font-size: 0.9rem; text-align: center; height: 20px;"></div>
                    </div>
                `;
            } else if (type === 'slides') {
                // Reset slide state
                currentSlide = 1;
                resultHTML = `
                    <h2 style="margin-bottom:10px;">Inspection Deck Ready</h2>
                    <div class="preview-box" style="background:white;">
                        <div class="slide-preview">
                            <div style="text-align:center;" id="slideContainer" class="slide-content">
                                <h3 style="color:var(--primary); margin-bottom: 12px; font-size: 1.8rem;">${slideContent[0].title}</h3>
                                <p style="font-size:1.1rem; color: var(--text-muted);">${slideContent[0].sub}</p>
                            </div>
                            <div style="position: absolute; bottom: 12px; right: 12px; font-size: 0.8rem; color: #ccc;">AlgoRythmn AI</div>
                        </div>
                        <div class="slide-controls">
                            <button class="btn-primary" style="padding:8px 16px;" onclick="changeSlide(-1)"><i class="fas fa-chevron-left"></i></button>
                            <span style="align-self:center; font-weight:600; min-width: 80px; text-align: center;" id="slideCounter">Slide 1 of ${totalSlides}</span>
                            <button class="btn-primary" style="padding:8px 16px;" onclick="changeSlide(1)"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                `;
            } else if (type === 'checklist' || type === 'form') {
                resultHTML = `
                     <h2 style="margin-bottom:10px;">${title} Generated</h2>
                     <div class="preview-box" style="background:white; text-align:left;">
                         <div style="display: flex; justify-content: space-between; margin-bottom: 16px;">
                            <span style="font-weight: 700;">Progress</span>
                            <span id="checkProgress">1/3</span>
                         </div>
                         <div class="progress-container" style="margin-bottom: 20px;">
                            <div class="progress-fill" id="checkBar" style="width: 33%;"></div>
                         </div>
                         
                        <div class="check-item" style="display:flex; gap:10px; margin-bottom:10px; padding:10px; border-bottom:1px solid #eee;">
                            <input type="checkbox" checked onclick="updateChecklist(this)"> <span style="text-decoration:line-through; color:#aaa;">Verify Narcotic Safe Logs</span>
                        </div>
                        <div class="check-item" style="display:flex; gap:10px; margin-bottom:10px; padding:10px; border-bottom:1px solid #eee;">
                            <input type="checkbox" onclick="updateChecklist(this)"> <span>Check Fridge Temp Logs (Jan)</span>
                        </div>
                        <div class="check-item" style="display:flex; gap:10px; margin-bottom:10px; padding:10px; border-bottom:1px solid #eee;">
                            <input type="checkbox" onclick="updateChecklist(this)"> <span>Sign Staff Training Matrix</span>
                        </div>
                     </div>
                `;
            }

            content.innerHTML = `
                <i class="fas fa-times modal-close" onclick="closeModal('genModal')"></i>
                <div style="text-align:center;">
                    <div style="font-size:3rem; color:var(--accent-green); margin-bottom:16px;"><i class="fas fa-check-circle"></i></div>
                    ${resultHTML}
                    <div style="margin-top:24px; display:flex; gap:10px; justify-content:center;">
                        <button class="btn-primary"><i class="fas fa-download"></i> Download</button>
                        <button class="btn-primary" style="background:white; color:var(--text-main); border:1px solid #ddd;">Edit</button>
                    </div>
                </div>
            `;
        }

        // === INTERACTIVE DEMO HANDLERS ===
        
        // 1. Audio
        function toggleAudio(btn) {
            const player = document.getElementById('audioPlayer');
            const icon = btn.querySelector('i');
            
            if (player.classList.contains('playing')) {
                player.classList.remove('playing');
                icon.className = 'fas fa-play';
            } else {
                player.classList.add('playing');
                icon.className = 'fas fa-pause';
            }
        }

        // 2. Quiz
        function runQuiz(el, isCorrect) {
            // Reset siblings
            el.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                opt.className = 'quiz-option';
            });

            if (isCorrect) {
                el.classList.add('correct');
                document.getElementById('quizFeedback').innerHTML = '<span style="color: #15803D"><i class="fas fa-check"></i> Correct! This ensures patient safety before release.</span>';
                showToast("Correct Answer!");
            } else {
                el.classList.add('wrong');
                document.getElementById('quizFeedback').innerHTML = '<span style="color: #991B1B"><i class="fas fa-times"></i> Incorrect. Consult Standard 18.2.</span>';
            }
        }

        // 3. Slides
        function changeSlide(dir) {
            const next = currentSlide + dir;
            if (next < 1 || next > totalSlides) return;
            
            currentSlide = next;
            
            // Update UI
            document.getElementById('slideCounter').innerText = `Slide ${currentSlide} of ${totalSlides}`;
            
            const content = slideContent[currentSlide - 1];
            const container = document.getElementById('slideContainer');
            
            // Animate
            container.style.opacity = '0';
            container.style.transform = 'translateX(10px)';
            
            setTimeout(() => {
                container.innerHTML = `
                    <h3 style="color:var(--primary); margin-bottom: 12px; font-size: 1.8rem;">${content.title}</h3>
                    <p style="font-size:1.1rem; color: var(--text-muted);">${content.sub}</p>
                `;
                container.style.opacity = '1';
                container.style.transform = 'translateX(0)';
            }, 200);
        }

        // 4. Checklist
        function updateChecklist(checkbox) {
            const row = checkbox.parentElement;
            const label = row.querySelector('span');
            
            if (checkbox.checked) {
                label.style.textDecoration = 'line-through';
                label.style.color = '#aaa';
            } else {
                label.style.textDecoration = 'none';
                label.style.color = 'inherit';
            }
            
            // Calc Progress
            const all = document.querySelectorAll('.check-item input');
            const checked = document.querySelectorAll('.check-item input:checked');
            const percent = (checked.length / all.length) * 100;
            
            document.getElementById('checkProgress').innerText = `${checked.length}/${all.length}`;
            document.getElementById('checkBar').style.width = `${percent}%`;
            
            if (percent === 100) showToast("All tasks completed!");
        }

        // 5. Settings
        function saveSettings() {
            const btn = document.getElementById('saveSettingsBtn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Saving...';
            btn.disabled = true;
            
            // Simulating API call
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                showToast("Configuration saved successfully");
            }, 1500);
        }

        // === STUDIO CHAT LOGIC ===
        function handleStudioChat(e) {
            if (e.key === 'Enter') sendStudioMessage();
        }

        function sendStudioMessage() {
            const input = document.getElementById('studioPromptInput');
            const message = input.value.trim();
            if (!message) return;

            const chatContainer = document.getElementById('studioChat');
            
            // Clear welcome message if it exists
            if (chatContainer.querySelector('div[style*="text-align: center"]')) {
                chatContainer.innerHTML = '';
            }

            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'chat-message user';
            userMsg.innerHTML = `<div class="chat-bubble">${message}</div>`;
            chatContainer.appendChild(userMsg);

            input.value = '';

            // Simulate AI response
            setTimeout(() => {
                const aiMsg = document.createElement('div');
                aiMsg.className = 'chat-message';
                aiMsg.innerHTML = `
                    <div class="chat-bubble">
                        <i class="fas fa-robot" style="margin-right: 8px; color: var(--primary);"></i>
                        Based on your sources, I can help you generate compliance content. Try clicking one of the Studio Tools on the right, or upload sources to get started.
                    </div>
                `;
                chatContainer.appendChild(aiMsg);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 1000);

            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // === UTILS ===
        function showToast(message) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `<i class="fas fa-info-circle"></i> ${message}`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function openModal(id) { document.getElementById(id).classList.add('open'); }
        function closeModal(id) { document.getElementById(id).classList.remove('open'); }

        function selectTone(el) {
            document.querySelectorAll('.tone-option').forEach(t => t.classList.remove('selected'));
            el.classList.add('selected');
        }

        function nextStep(stepNum) {
            document.querySelectorAll('.wizard-step').forEach(s => s.classList.remove('active'));
            document.getElementById('step' + stepNum).classList.add('active');
        }

        // === ENHANCED STUDIO TOOL FUNCTIONS ===
        function openToolWizard(toolType) {
            const modal = document.getElementById('toolWizardModal');
            const content = document.getElementById('toolWizardContent');
            
            // Highlight the selected tool
            document.querySelectorAll('.studio-tool-item').forEach(item => {
                item.style.background = 'var(--bg-subtle)';
            });
            event.currentTarget.style.background = 'var(--primary-light)';
            event.currentTarget.style.borderColor = 'var(--primary)';
            
            setTimeout(() => {
                event.currentTarget.style.background = 'var(--bg-subtle)';
                event.currentTarget.style.borderColor = 'transparent';
            }, 300);
            
            let wizardHTML = '';
            
            switch(toolType) {
                case 'audio':
                    wizardHTML = `
                        <div style="text-align: center; margin-bottom: 24px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                                <i class="fas fa-microphone"></i>
                            </div>
                            <h2 style="margin-bottom: 8px;">Audio Briefing Generator</h2>
                            <p style="color: var(--text-muted);">Create a professional audio summary of your compliance documents</p>
                        </div>
                        
                        <div style="background: var(--bg-subtle); padding: 24px; border-radius: 12px; margin-bottom: 24px;">
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Briefing Duration</label>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
                                <div class="tone-option selected" onclick="selectTone(this)">
                                    <i class="fas fa-clock" style="font-size: 1.5rem; margin-bottom: 8px;"></i>
                                    <div style="font-weight: 700;">3 mins</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Quick brief</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <i class="fas fa-clock" style="font-size: 1.5rem; margin-bottom: 8px;"></i>
                                    <div style="font-weight: 700;">5 mins</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Standard</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <i class="fas fa-clock" style="font-size: 1.5rem; margin-bottom: 8px;"></i>
                                    <div style="font-weight: 700;">10 mins</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Detailed</div>
                                </div>
                            </div>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Voice Style</label>
                            <select style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 20px;">
                                <option>Professional Female</option>
                                <option>Professional Male</option>
                                <option>Conversational Female</option>
                                <option>Conversational Male</option>
                            </select>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Content Focus</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                <div class="chip" style="background: var(--primary); color: white; border-color: var(--primary);">Key Changes</div>
                                <div class="chip" onclick="this.style.background='var(--primary)'; this.style.color='white';">Action Items</div>
                                <div class="chip" onclick="this.style.background='var(--primary)'; this.style.color='white';">Deadlines</div>
                                <div class="chip" onclick="this.style.background='var(--primary)'; this.style.color='white';">Statistics</div>
                            </div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%); padding: 16px 20px; border-radius: 12px; margin-bottom: 24px; border: 1px solid #BAE6FD;">
                            <div style="display: flex; gap: 12px;">
                                <i class="fas fa-lightbulb" style="color: #0284C7; font-size: 1.2rem;"></i>
                                <div style="flex: 1;">
                                    <strong style="color: #0369A1;">Pro Tip:</strong>
                                    <p style="font-size: 0.9rem; color: #0C4A6E; margin: 4px 0 0 0;">Audio briefings are perfect for busy pharmacists. Listen during commute or breaks to stay current on regulations.</p>
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn-primary" style="width: 100%; padding: 16px; font-size: 1rem;" onclick="startGeneration('Audio Briefing', 'audio')">
                            <i class="fas fa-magic"></i> Generate Audio Briefing
                        </button>
                    `;
                    break;
                    
                case 'quiz':
                    wizardHTML = `
                        <div style="text-align: center; margin-bottom: 24px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #DBEAFE 0%, #3B82F6 100%); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                                <i class="fas fa-question-circle"></i>
                            </div>
                            <h2 style="margin-bottom: 8px;">Staff Training Quiz Generator</h2>
                            <p style="color: var(--text-muted);">Create engaging assessments to test compliance knowledge</p>
                        </div>
                        
                        <div style="background: var(--bg-subtle); padding: 24px; border-radius: 12px; margin-bottom: 24px;">
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Quiz Difficulty</label>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
                                <div class="tone-option" onclick="selectTone(this)">
                                    <i class="fas fa-smile" style="font-size: 1.5rem; margin-bottom: 8px; color: #10B981;"></i>
                                    <div style="font-weight: 700;">Beginner</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Basic concepts</div>
                                </div>
                                <div class="tone-option selected" onclick="selectTone(this)">
                                    <i class="fas fa-meh" style="font-size: 1.5rem; margin-bottom: 8px; color: #F59E0B;"></i>
                                    <div style="font-weight: 700;">Intermediate</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Standard level</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <i class="fas fa-frown" style="font-size: 1.5rem; margin-bottom: 8px; color: #EF4444;"></i>
                                    <div style="font-weight: 700;">Advanced</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Expert level</div>
                                </div>
                            </div>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Number of Questions</label>
                            <input type="range" min="5" max="20" value="10" style="width: 100%; margin-bottom: 8px;" oninput="document.getElementById('qCount').innerText = this.value">
                            <div style="text-align: center; color: var(--text-muted); font-size: 0.9rem;"><span id="qCount">10</span> questions</div>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px; margin-top: 20px;">Question Types</label>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 20px; height: 20px;">
                                    <span>Multiple Choice</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 20px; height: 20px;">
                                    <span>True/False</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" style="width: 20px; height: 20px;">
                                    <span>Scenario-Based</span>
                                </label>
                            </div>
                        </div>
                        
                        <button class="btn-primary" style="width: 100%; padding: 16px; font-size: 1rem;" onclick="startGeneration('Staff Training Quiz', 'quiz')">
                            <i class="fas fa-magic"></i> Generate Quiz
                        </button>
                    `;
                    break;
                    
                case 'slides':
                    wizardHTML = `
                        <div style="text-align: center; margin-bottom: 24px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #FEE2E2 0%, #EF4444 100%); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                                <i class="fas fa-presentation"></i>
                            </div>
                            <h2 style="margin-bottom: 8px;">Slide Deck Generator</h2>
                            <p style="color: var(--text-muted);">Create professional presentations for inspections and training</p>
                        </div>
                        
                        <div style="background: var(--bg-subtle); padding: 24px; border-radius: 12px; margin-bottom: 24px;">
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Presentation Title</label>
                            <input type="text" placeholder="e.g. 2026 Compliance Update" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 20px;">
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Slide Theme</label>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
                                <div class="tone-option selected" onclick="selectTone(this)">
                                    <div style="width: 40px; height: 30px; background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); border-radius: 4px; margin: 0 auto 8px;"></div>
                                    <div style="font-weight: 700; font-size: 0.85rem;">Professional</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <div style="width: 40px; height: 30px; background: linear-gradient(135deg, #3B82F6 0%, #1E40AF 100%); border-radius: 4px; margin: 0 auto 8px;"></div>
                                    <div style="font-weight: 700; font-size: 0.85rem;">Modern</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <div style="width: 40px; height: 30px; background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%); border-radius: 4px; margin: 0 auto 8px;"></div>
                                    <div style="font-weight: 700; font-size: 0.85rem;">Energetic</div>
                                </div>
                            </div>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Include Sections</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                <div class="chip" style="background: var(--primary); color: white; border-color: var(--primary);">Title Slide</div>
                                <div class="chip" style="background: var(--primary); color: white; border-color: var(--primary);">Key Updates</div>
                                <div class="chip" onclick="this.style.background='var(--primary)'; this.style.color='white';">Action Items</div>
                                <div class="chip" onclick="this.style.background='var(--primary)'; this.style.color='white';">Timeline</div>
                                <div class="chip" onclick="this.style.background='var(--primary)'; this.style.color='white';">Q&A</div>
                            </div>
                        </div>
                        
                        <button class="btn-primary" style="width: 100%; padding: 16px; font-size: 1rem;" onclick="startGeneration('Inspection Slide Deck', 'slides')">
                            <i class="fas fa-magic"></i> Generate Slides
                        </button>
                    `;
                    break;
                    
                case 'checklist':
                    wizardHTML = `
                        <div style="text-align: center; margin-bottom: 24px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #D1FAE5 0%, #10B981 100%); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                                <i class="fas fa-clipboard-check"></i>
                            </div>
                            <h2 style="margin-bottom: 8px;">Audit Checklist Generator</h2>
                            <p style="color: var(--text-muted);">Create comprehensive compliance checklists</p>
                        </div>
                        
                        <div style="background: var(--bg-subtle); padding: 24px; border-radius: 12px; margin-bottom: 24px;">
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Audit Type</label>
                            <select style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 20px;">
                                <option>Pre-Inspection Self-Audit</option>
                                <option>Narcotic Inventory Check</option>
                                <option>Cold Chain Compliance</option>
                                <option>Sterile Compounding</option>
                                <option>Prescription Processing</option>
                                <option>Custom Checklist</option>
                            </select>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Regulatory Framework</label>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px;">
                                <div class="tone-option selected" onclick="selectTone(this)">
                                    <i class="fas fa-flag" style="font-size: 1.2rem; margin-bottom: 8px;"></i>
                                    <div style="font-weight: 700; font-size: 0.9rem;">Provincial</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <i class="fas fa-globe" style="font-size: 1.2rem; margin-bottom: 8px;"></i>
                                    <div style="font-weight: 700; font-size: 0.9rem;">Federal</div>
                                </div>
                            </div>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Checklist Features</label>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 20px; height: 20px;">
                                    <span>Include regulatory citations</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 20px; height: 20px;">
                                    <span>Priority indicators (High/Med/Low)</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" style="width: 20px; height: 20px;">
                                    <span>Evidence documentation fields</span>
                                </label>
                            </div>
                        </div>
                        
                        <button class="btn-primary" style="width: 100%; padding: 16px; font-size: 1rem;" onclick="startGeneration('Audit Checklist', 'checklist')">
                            <i class="fas fa-magic"></i> Generate Checklist
                        </button>
                    `;
                    break;
                    
                case 'leaflet':
                    wizardHTML = `
                        <div style="text-align: center; margin-bottom: 24px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #E0E7FF 0%, #6366F1 100%); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <h2 style="margin-bottom: 8px;">Patient Leaflet Generator</h2>
                            <p style="color: var(--text-muted);">Create clear, accessible patient education materials</p>
                        </div>
                        
                        <div style="background: var(--bg-subtle); padding: 24px; border-radius: 12px; margin-bottom: 24px;">
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Topic</label>
                            <input type="text" placeholder="e.g. Opioid Safety, Diabetes Management" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 20px;">
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Reading Level</label>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
                                <div class="tone-option" onclick="selectTone(this)">
                                    <div style="font-weight: 700;">Grade 6-8</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Very Simple</div>
                                </div>
                                <div class="tone-option selected" onclick="selectTone(this)">
                                    <div style="font-weight: 700;">Grade 9-10</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Recommended</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <div style="font-weight: 700;">Grade 11+</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">Advanced</div>
                                </div>
                            </div>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Language</label>
                            <select style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 20px;">
                                <option>English</option>
                                <option>French</option>
                                <option>Spanish</option>
                                <option>Mandarin</option>
                                <option>Arabic</option>
                            </select>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Include</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                <div class="chip" style="background: var(--primary); color: white; border-color: var(--primary);">Instructions</div>
                                <div class="chip" style="background: var(--primary); color: white; border-color: var(--primary);">Side Effects</div>
                                <div class="chip" onclick="this.style.background='var(--primary)'; this.style.color='white';">Illustrations</div>
                                <div class="chip" onclick="this.style.background='var(--primary)'; this.style.color='white';">FAQ</div>
                            </div>
                        </div>
                        
                        <button class="btn-primary" style="width: 100%; padding: 16px; font-size: 1rem;" onclick="startGeneration('Patient Leaflet', 'leaflet')">
                            <i class="fas fa-magic"></i> Generate Leaflet
                        </button>
                    `;
                    break;
                    
                case 'incident':
                    wizardHTML = `
                        <div style="text-align: center; margin-bottom: 24px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #FEF3C7 0%, #F59E0B 100%); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <h2 style="margin-bottom: 8px;">Incident Report Generator</h2>
                            <p style="color: var(--text-muted);">Document errors and near-misses professionally</p>
                        </div>
                        
                        <div style="background: var(--bg-subtle); padding: 24px; border-radius: 12px; margin-bottom: 24px;">
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Incident Type</label>
                            <select style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-subtle); margin-bottom: 20px;">
                                <option>Medication Error</option>
                                <option>Near Miss</option>
                                <option>Patient Safety Event</option>
                                <option>Equipment Failure</option>
                                <option>Security Breach</option>
                                <option>Other</option>
                            </select>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Severity Level</label>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px;">
                                <div class="tone-option" onclick="selectTone(this)">
                                    <i class="fas fa-check-circle" style="font-size: 1.2rem; margin-bottom: 8px; color: #10B981;"></i>
                                    <div style="font-weight: 700; font-size: 0.85rem;">Minor</div>
                                </div>
                                <div class="tone-option selected" onclick="selectTone(this)">
                                    <i class="fas fa-exclamation-circle" style="font-size: 1.2rem; margin-bottom: 8px; color: #F59E0B;"></i>
                                    <div style="font-weight: 700; font-size: 0.85rem;">Moderate</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <i class="fas fa-exclamation-triangle" style="font-size: 1.2rem; margin-bottom: 8px; color: #EF4444;"></i>
                                    <div style="font-weight: 700; font-size: 0.85rem;">Serious</div>
                                </div>
                                <div class="tone-option" onclick="selectTone(this)">
                                    <i class="fas fa-times-circle" style="font-size: 1.2rem; margin-bottom: 8px; color: #991B1B;"></i>
                                    <div style="font-weight: 700; font-size: 0.85rem;">Critical</div>
                                </div>
                            </div>
                            
                            <label style="font-weight: 600; display: block; margin-bottom: 12px;">Report Sections</label>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 20px; height: 20px;">
                                    <span>Incident Description</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 20px; height: 20px;">
                                    <span>Root Cause Analysis</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" checked style="width: 20px; height: 20px;">
                                    <span>Corrective Actions</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                    <input type="checkbox" style="width: 20px; height: 20px;">
                                    <span>Prevention Plan</span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #FEF2F2 0%, #FEE2E2 100%); padding: 16px 20px; border-radius: 12px; margin-bottom: 24px; border: 1px solid #FECACA;">
                            <div style="display: flex; gap: 12px;">
                                <i class="fas fa-shield-alt" style="color: #DC2626; font-size: 1.2rem;"></i>
                                <div style="flex: 1;">
                                    <strong style="color: #991B1B;">Important:</strong>
                                    <p style="font-size: 0.9rem; color: #7F1D1D; margin: 4px 0 0 0;">This report may be required by your regulatory college. Ensure all details are accurate and complete.</p>
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn-primary" style="width: 100%; padding: 16px; font-size: 1rem;" onclick="startGeneration('Incident Report', 'form')">
                            <i class="fas fa-magic"></i> Generate Report Template
                        </button>
                    `;
                    break;
            }
            
            content.innerHTML = wizardHTML;
            modal.classList.add('open');
            showToast('Configure your content generation settings');
        }

        // === FILE UPLOAD FUNCTIONALITY ===
        let selectedFiles = [];
        let uploadedSources = [];

        // Drag and drop handlers
        document.addEventListener('DOMContentLoaded', () => {
            const dropZone = document.getElementById('dropZone');
            if (dropZone) {
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('drag-over');
                });
                
                dropZone.addEventListener('dragleave', () => {
                    dropZone.classList.remove('drag-over');
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('drag-over');
                    handleFileSelect({ target: { files: e.dataTransfer.files } });
                });
            }
        });

        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            selectedFiles = [...selectedFiles, ...files];
            displayFilesList();
        }

        function displayFilesList() {
            const filesList = document.getElementById('filesList');
            const uploadPreview = document.getElementById('uploadPreview');
            const fileCount = document.getElementById('fileCount');
            
            if (selectedFiles.length === 0) {
                uploadPreview.style.display = 'none';
                return;
            }
            
            uploadPreview.style.display = 'block';
            fileCount.textContent = selectedFiles.length;
            
            filesList.innerHTML = selectedFiles.map((file, index) => {
                const sizeKB = (file.size / 1024).toFixed(1);
                const sizeMB = (file.size / 1024 / 1024).toFixed(1);
                const sizeText = file.size > 1024 * 1024 ? `${sizeMB} MB` : `${sizeKB} KB`;
                
                let icon = 'fa-file';
                if (file.type.includes('pdf')) icon = 'fa-file-pdf';
                else if (file.type.includes('video')) icon = 'fa-file-video';
                else if (file.type.includes('audio')) icon = 'fa-file-audio';
                else if (file.type.includes('text') || file.name.endsWith('.txt')) icon = 'fa-file-alt';
                else if (file.type.includes('word')) icon = 'fa-file-word';
                
                return `
                    <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border: 1px solid var(--border-subtle); border-radius: 8px; margin-bottom: 8px;">
                        <i class="fas ${icon}" style="font-size: 1.5rem; color: var(--primary);"></i>
                        <div style="flex: 1; min-width: 0;">
                            <div style="font-weight: 600; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${file.name}</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">${sizeText}</div>
                        </div>
                        <i class="fas fa-times" style="color: var(--text-muted); cursor: pointer; padding: 8px;" onclick="removeFile(${index})"></i>
                    </div>
                `;
            }).join('');
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            displayFilesList();
        }

        function uploadFiles() {
            if (selectedFiles.length === 0) return;
            
            // Simulate upload process
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Uploading...';
            btn.disabled = true;
            
            setTimeout(() => {
                // Add files to uploaded sources
                selectedFiles.forEach(file => {
                    let type = 'text';
                    if (file.type.includes('pdf')) type = 'pdf';
                    else if (file.type.includes('video')) type = 'video';
                    else if (file.type.includes('audio')) type = 'audio';
                    
                    uploadedSources.push({
                        name: file.name,
                        type: type,
                        size: file.size,
                        date: new Date().toLocaleDateString()
                    });
                });
                
                // Update resources list
                updateResourcesList();
                
                // Reset and close
                selectedFiles = [];
                btn.innerHTML = originalText;
                btn.disabled = false;
                closeModal('uploadModal');
                showToast(`${uploadedSources.length} source(s) uploaded successfully`);
                
                // Reset file input
                document.getElementById('fileInput').value = '';
                document.getElementById('uploadPreview').style.display = 'none';
            }, 1500);
        }

        function addSampleFile(fileName, type) {
            uploadedSources.push({
                name: fileName,
                type: type,
                size: Math.floor(Math.random() * 5000000) + 100000,
                date: new Date().toLocaleDateString()
            });
            updateResourcesList();
            closeModal('uploadModal');
            showToast(`Added "${fileName}" to sources`);
        }

        function updateResourcesList() {
            const resourcesList = document.getElementById('resourcesList');
            const resourcesHeader = document.querySelector('.resources-header p');
            
            // Update count
            resourcesHeader.textContent = `${uploadedSources.length} source${uploadedSources.length !== 1 ? 's' : ''}`;
            
            if (uploadedSources.length === 0) {
                resourcesList.innerHTML = `
                    <div style="text-align: center; color: var(--text-muted); padding: 40px 20px; font-size: 0.9rem;">
                        <i class="fas fa-folder-open" style="font-size: 2rem; display: block; margin-bottom: 12px; opacity: 0.3;"></i>
                        Upload sources to add context for AI generation
                    </div>
                `;
                return;
            }
            
            resourcesList.innerHTML = uploadedSources.map((source, index) => {
                let icon = 'fa-file';
                let tagClass = 'tag-text';
                
                if (source.type === 'pdf') {
                    icon = 'fa-file-pdf';
                    tagClass = 'tag-pdf';
                } else if (source.type === 'video') {
                    icon = 'fa-file-video';
                    tagClass = 'tag-video';
                } else if (source.type === 'audio') {
                    icon = 'fa-file-audio';
                    tagClass = 'tag-audio';
                }
                
                const sizeKB = (source.size / 1024).toFixed(0);
                const sizeMB = (source.size / 1024 / 1024).toFixed(1);
                const sizeText = source.size > 1024 * 1024 ? `${sizeMB} MB` : `${sizeKB} KB`;
                
                return `
                    <div class="resource-item" style="position: relative; padding-right: 40px;">
                        <div style="display: flex; align-items: start; gap: 12px;">
                            <i class="fas ${icon}"></i>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 0.9rem; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${source.name}</div>
                                <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                                    <span class="resource-tag ${tagClass}">${source.type}</span>
                                    <span style="font-size: 0.75rem; color: var(--text-muted);">${sizeText}</span>
                                </div>
                            </div>
                        </div>
                        <i class="fas fa-times" style="position: absolute; top: 12px; right: 12px; color: var(--text-muted); cursor: pointer; padding: 8px; opacity: 0; transition: 0.2s;" onmouseover="this.style.color='#EF4444'" onmouseout="this.style.color='var(--text-muted)'" onclick="removeSource(${index}); event.stopPropagation();"></i>
                    </div>
                `;
            }).join('');
            
            // Add hover effect to show delete button
            document.querySelectorAll('.resource-item').forEach(item => {
                item.addEventListener('mouseenter', function() {
                    this.querySelector('.fa-times').style.opacity = '1';
                });
                item.addEventListener('mouseleave', function() {
                    this.querySelector('.fa-times').style.opacity = '0';
                });
            });
        }

        function removeSource(index) {
            uploadedSources.splice(index, 1);
            updateResourcesList();
            showToast('Source removed');
        }
    </script>
</body>
</html>